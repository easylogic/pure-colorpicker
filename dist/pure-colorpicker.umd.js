(function(O,E){typeof exports=="object"&&typeof module!="undefined"?module.exports=E():typeof define=="function"&&define.amd?define(E):(O=typeof globalThis!="undefined"?globalThis:O||self,O.PureColorPicker=E())})(this,function(){"use strict";var ka=Object.defineProperty,Ma=Object.defineProperties;var Ea=Object.getOwnPropertyDescriptors;var xr=Object.getOwnPropertySymbols;var Ia=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable;var yr=(O,E,X)=>E in O?ka(O,E,{enumerable:!0,configurable:!0,writable:!0,value:X}):O[E]=X,$=(O,E)=>{for(var X in E||(E={}))Ia.call(E,X)&&yr(O,X,E[X]);if(xr)for(var X of xr(E))Pa.call(E,X)&&yr(O,X,E[X]);return O},Q=(O,E)=>Ma(O,Ea(E));var O="";function E(r,t,e="rgba(0, 0, 0, 0)"){return Array.isArray(r)&&(r={r:r[0],g:r[1],b:r[2],a:r[3]}),t=="hex"?X(r):t=="rgb"?oe(r,e):t=="hsl"?le(r):r}function X(r){Array.isArray(r)&&(r={r:r[0],g:r[1],b:r[2],a:r[3]});var t=r.r.toString(16);r.r<16&&(t="0"+t);var e=r.g.toString(16);r.g<16&&(e="0"+e);var i=r.b.toString(16);r.b<16&&(i="0"+i);var s="";if(r.a<1){var a=Math.floor(r.a*255),s=a.toString(16);a<16&&(s="0"+s)}return`#${t}${e}${i}${s}`}function oe(r,t="rgba(0, 0, 0, 0)"){if(Array.isArray(r)&&(r={r:r[0],g:r[1],b:r[2],a:r[3]}),typeof r!="undefined")return r.a==1||typeof r.a=="undefined"?isNaN(r.r)?t:`rgb(${r.r},${r.g},${r.b})`:`rgba(${r.r},${r.g},${r.b},${r.a})`}function le(r){return Array.isArray(r)&&(r={r:r[0],g:r[1],b:r[2],a:r[3]}),r.a==1||typeof r.a=="undefined"?`hsl(${r.h},${r.s}%,${r.l}%)`:`hsla(${r.h},${r.s}%,${r.l}%,${r.a})`}var wr={format:E,rgb:oe,hsl:le,hex:X};function P(r,t){return t=typeof t=="undefined"?1:t,Math.round(r*t)/t}function Bt(r){return r*Math.PI/180}function ce(r){var t=r*180/Math.PI;return t<0&&(t=360+t),t}function he(r,t,e=0){return e+t*Math.cos(Bt(r))}function ue(r,t,e=0){return e+t*Math.sin(Bt(r))}function Sr(r,t,e=0,i=0){return{x:he(r,t,e),y:ue(r,t,i)}}function bt(r,t){return ce(Math.atan2(t,r))}var kr={round:P,radianToDegree:ce,degreeToRadian:Bt,getXInCircle:he,getYInCircle:ue,caculateAngle:bt};const fe={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb(0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb(95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(237, 20, 61)",cyan:"rgb(0, 255, 255)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgrey:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb(0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",grey:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",greenyellow:"rgb(173, 255, 47)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb(75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgreen:"rgb(144, 238, 144)",lightgray:"rgb(211, 211, 211)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb(0, 255, 0)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",rebeccapurple:"rgb(102, 51, 153)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb(65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb(0, 255, 127)",steelblue:"rgb(70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb(0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",turquoise:"rgb(64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)",transparent:"rgba(0, 0, 0, 0)"};function Mr(r){return!!fe[r]}function Er(r){return fe[r]}var xt={isColorName:Mr,getColorByName:Er};function yt(r,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?r+(t-r)*6*e:e<1/2?t:e<2/3?r+(t-r)*(2/3-e)*6:r}function Ir(r,t,e){if(arguments.length==1)var{h:r,s:t,l:e}=arguments[0];const i=wt(r,t,e);return Gt(i.r,i.g,i.b)}function wt(r,t,e){if(arguments.length==1)var{h:r,s:t,l:e}=arguments[0];var i,s,a;if(r/=360,t/=100,e/=100,t==0)i=s=a=e;else{var n=e<.5?e*(1+t):e+t-e*t,o=2*e-n;i=yt(o,n,r+1/3),s=yt(o,n,r),a=yt(o,n,r-1/3)}return{r:P(i*255),g:P(s*255),b:P(a*255)}}var Pr={HUEtoRGB:yt,HSLtoHSV:Ir,HSLtoRGB:wt};const de=/(#(?:[\da-f]{3}){1,2}|#(?:[\da-f]{8})|rgb\((?:\s*\d{1,3},\s*){2}\d{1,3}\s*\)|rgba\((?:\s*\d{1,3},\s*){3}\d*\.?\d+\s*\)|hsl\(\s*\d{1,3}(?:,\s*\d{1,3}%){2}\s*\)|hsla\(\s*\d{1,3}(?:,\s*\d{1,3}%){2},\s*\d*\.?\d+\s*\)|([\w_\-]+))/gi,Tr=",";function ge(r){const t=r.match(de);let e=[];if(!t)return e;for(var i=0,s=t.length;i<s;i++)if(t[i].indexOf("#")>-1||t[i].indexOf("rgb")>-1||t[i].indexOf("hsl")>-1)e.push({color:t[i]});else{var a=xt.getColorByName(t[i]);a&&e.push({color:t[i],nameColor:a})}var n={next:0};return e.forEach(o=>{const l=r.indexOf(o.color,n.next);o.startIndex=l,o.endIndex=l+o.color.length,n.next=o.endIndex}),e}function j(r){const t=ge(r);return t.forEach((e,i)=>{r=r.replace(e.color,"@"+i)}),{str:r,matches:t}}function Lt(r,t=","){const e=j(r);return e.str.split(t).map((i,s)=>(i=W(i),e.matches[s]&&(i=i.replace("@"+s,e.matches[s].color)),i))}function tt(r,t){return t.forEach((e,i)=>{r=r.replace("@"+i,e.color)}),r}function W(r){return r.replace(/^\s+|\s+$/g,"")}function vt(r){if(typeof r=="string"){if(xt.isColorName(r)&&(r=xt.getColorByName(r)),r.indexOf("rgb(")>-1){for(var t=r.replace("rgb(","").replace(")","").split(","),e=0,i=t.length;e<i;e++)t[e]=parseInt(W(t[e]),10);var s={type:"rgb",r:t[0],g:t[1],b:t[2],a:1};return s=Object.assign(s,et(s)),s}else if(r.indexOf("rgba(")>-1){for(var t=r.replace("rgba(","").replace(")","").split(","),e=0,i=t.length;e<i;e++)i-1==e?t[e]=parseFloat(W(t[e])):t[e]=parseInt(W(t[e]),10);var s={type:"rgb",r:t[0],g:t[1],b:t[2],a:t[3]};return s=Object.assign(s,et(s)),s}else if(r.indexOf("hsl(")>-1){for(var t=r.replace("hsl(","").replace(")","").split(","),e=0,i=t.length;e<i;e++)t[e]=parseFloat(W(t[e]));var s={type:"hsl",h:t[0],s:t[1],l:t[2],a:1};return s=Object.assign(s,wt(s)),s}else if(r.indexOf("hsla(")>-1){for(var t=r.replace("hsla(","").replace(")","").split(","),e=0,i=t.length;e<i;e++)i-1==e?t[e]=parseFloat(W(t[e])):t[e]=parseInt(W(t[e]),10);var s={type:"hsl",h:t[0],s:t[1],l:t[2],a:t[3]};return s=Object.assign(s,wt(s)),s}else if(r.indexOf("#")==0){r=r.replace("#","");var t=[],a=1;if(r.length==3)for(var e=0,i=r.length;e<i;e++){var n=r.substr(e,1);t.push(parseInt(n+n,16))}else if(r.length===8){for(var e=0,i=r.length;e<i;e+=2)t.push(parseInt(r.substr(e,2),16));a=t.pop()/255}else for(var e=0,i=r.length;e<i;e+=2)t.push(parseInt(r.substr(e,2),16));var s={type:"hex",r:t[0],g:t[1],b:t[2],a};return s=Object.assign(s,et(s)),s}}else if(typeof r=="number"){if(0<=r&&r<=16777215){const o=(r&16711680)>>16,l=(r&65280)>>8,c=(r&255)>>0;var s={type:"hex",r:o,g:l,b:c,a:1};return s=Object.assign(s,et(s)),s}else if(0<=r&&r<=4294967295){const o=(r&4278190080)>>24,l=(r&16711680)>>16,c=(r&65280)>>8,h=(r&255)/255;var s={type:"hex",r:o,g:l,b:c,a:h};return s=Object.assign(s,et(s)),s}}return r}function pe(r){typeof r=="string"&&(r=Lt(r)),r=r.map(e=>{if(typeof e=="string"){const i=j(e);let s=W(i.str).split(" ");return s[1]?s[1].includes("%")?s[1]=parseFloat(s[1].replace(/%/,""))/100:s[1]=parseFloat(s[1]):s[1]="*",s[0]=tt(s[0],i.matches),s}else if(Array.isArray(e))return e[1]?typeof e[1]=="string"&&(e[1].includes("%")?e[1]=parseFloat(e[1].replace(/%/,""))/100:e[1]=+e[1]):e[1]="*",[...e]});const t=r.filter(e=>e[1]==="*").length;if(t>0){const e=r.filter(s=>s[1]!="*"&&s[1]!=1).map(s=>s[1]).reduce((s,a)=>s+a,0),i=(1-e)/t;r.forEach((s,a)=>{s[1]=="*"&&a>0&&(r.length-1==a||(s[1]=i))})}return r}var Dr={matches:ge,convertMatches:j,convertMatchesArray:Lt,reverseMatches:tt,parse:vt,parseGradient:pe,trim:W,color_regexp:de,color_split:Tr};function Gt(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];const i=r/255,s=t/255,a=e/255,n=Math.max(i,s,a),o=Math.min(i,s,a),l=n-o;var c=0;l==0?c=0:n==i?c=60*((s-a)/l%6):n==s?c=60*((a-i)/l+2):n==a&&(c=60*((i-s)/l+4)),c<0&&(c=360+c);var h=0;n==0?h=0:h=l/n;var u=n;return{h:c,s:h,v:u}}function Ur(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];const i=r/255,s=t/255,a=e/255,n=1-Math.max(i,s,a),o=(1-i-n)/(1-n),l=(1-s-n)/(1-n),c=(1-a-n)/(1-n);return{c:o,m:l,y:c,k:n}}function et(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];r/=255,t/=255,e/=255;var i=Math.max(r,t,e),s=Math.min(r,t,e),a,n,o=(i+s)/2;if(i==s)a=n=0;else{var l=i-s;switch(n=o>.5?l/(2-i-s):l/(i+s),i){case r:a=(t-e)/l+(t<e?6:0);break;case t:a=(e-r)/l+2;break;case e:a=(r-t)/l+4;break}a/=6}return{h:P(a*360),s:P(n*100),l:P(o*100)}}function Rr(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];return St((r+t+e)/3>90?0:255)}function St(r){return{r,g:r,b:r}}function Vr(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];return St(Math.ceil((r+t+e)/3))}function Hr(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];return St($e(r,t,e).y)}function ve(r,t,e){return Math.ceil(r*.2126+t*.7152+e*.0722)}function $e(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];const i=ve(r,t,e),s=.564*(e-i),a=.713*(r-i);return{y:i,cr:a,cb:s}}function Xt(r,t=.04045){return(r>t?Math.pow((r+.055)/1.055,2.4):r/12.92)*100}function me(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];let i=r/255,s=t/255,a=e/255;i=Xt(i),s=Xt(s),a=Xt(a);const n=i*.4124+s*.3576+a*.1805,o=i*.2126+s*.7152+a*.0722,l=i*.0193+s*.1192+a*.9505;return{x:n,y:o,z:l}}function Or(r,t,e){if(arguments.length==1)var{r,g:t,b:e}=arguments[0];return XYZtoLAB(me(r,t,e))}var Ar={RGBtoCMYK:Ur,RGBtoGray:Hr,RGBtoHSL:et,RGBtoHSV:Gt,RGBtoLAB:Or,RGBtoSimpleGray:Vr,RGBtoXYZ:me,RGBtoYCrCb:$e,c:Rr,brightness:ve,gray:St};function Nr(r,t,e,i){if(arguments.length==1)var{c:r,m:t,y:e,k:i}=arguments[0];const s=255*(1-r)*(1-i),a=255*(1-t)*(1-i),n=255*(1-e)*(1-i);return{r:s,g:a,b:n}}var Fr={CMYKtoRGB:Nr};function _t(r){return Math.pow(r,3)>.008856?Math.pow(r,3):(r-16/116)/7.787}function Yt(r){return r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r}function Ce(r,t,e){if(arguments.length==1)var{x:r,y:t,z:e}=arguments[0];let i=r/100,s=t/100,a=e/100,n=i*3.2406+s*-1.5372+a*-.4986,o=i*-.9689+s*1.8758+a*.0415,l=i*.0557+s*-.204+a*1.057;n=Yt(n),o=Yt(o),l=Yt(l);const c=P(n*255),h=P(o*255),u=P(l*255);return{r:c,g:h,b:u}}function be(r,t,e){if(arguments.length==1)var{l:r,a:t,b:e}=arguments[0];let i=(r+16)/116,s=t/500+i,a=i-e/200;i=_t(i),s=_t(s),a=_t(a);const n=s*95.047,o=i*100,l=a*108.883;return{x:n,y:o,z:l}}function Br(r,t,e){if(arguments.length==1)var{l:r,a:t,b:e}=arguments[0];return Ce(be(r,t,e))}var Lr={XYZtoRGB:Ce,LABtoRGB:Br,LABtoXYZ:be};function zt(r,t,e){if(arguments.length==1)var{h:r,s:t,v:e}=arguments[0];var i=r,s=t,a=e;i>=360&&(i=0);const n=s*a,o=n*(1-Math.abs(i/60%2-1)),l=a-n;let c=[];return 0<=i&&i<60?c=[n,o,0]:60<=i&&i<120?c=[o,n,0]:120<=i&&i<180?c=[0,n,o]:180<=i&&i<240?c=[0,o,n]:240<=i&&i<300?c=[o,0,n]:300<=i&&i<360&&(c=[n,0,o]),{r:P((c[0]+l)*255),g:P((c[1]+l)*255),b:P((c[2]+l)*255)}}function Gr(r,t,e){if(arguments.length==1)var{h:r,s:t,v:e}=arguments[0];const i=zt(r,t,e);return et(i.r,i.g,i.b)}var Xr={HSVtoHSL:Gr,HSVtoRGB:zt};function _r(r,t,e,i){if(arguments.length==1){var{y:r,cr:t,cb:e,bit:i}=arguments[0];i=i||0}const s=r+1.402*(t-i),a=r-.344*(e-i)-.714*(t-i),n=r+1.772*(e-i);return{r:Math.ceil(s),g:Math.ceil(a),b:Math.ceil(n)}}var Yr={YCrCbtoRGB:_r};function xe(r,t,e=.5,i="hex"){var s={r:P(r.r+(t.r-r.r)*e),g:P(r.g+(t.g-r.g)*e),b:P(r.b+(t.b-r.b)*e),a:P(r.a+(t.a-r.a)*e,100)};return E(s,s.a<1?"rgb":i)}function R(r,t=5){if(!r)return[];typeof r=="string"&&(r=Lt(r)),r=r||[];for(var e=r.length,i=[],s=0;s<e-1;s++)for(var a=0;a<t;a++)i.push(Kt(r[s],r[s+1],a/t));return i}function Kt(r,t,e=.5,i="hex"){var s=vt(r),a=vt(t);return xe(s,a,e,i)}function zr(r,t,e=.5,i="hex"){return Kt(r,t,e,i)}function ye(r){return r=vt(r),(Math.round(r.r*299)+Math.round(r.g*587)+Math.round(r.b*114))/1e3}function Kr(r){return ye(r)>=128?"black":"white"}function jr(r,t=10){r=pe(r);let e=[],i=t-(r.length-1),s=i;for(var a=1,n=r.length;a<n;a++){var o=r[a-1][0],l=r[a][0],c=a==1?r[a][1]:r[a][1]-r[a-1][1],h=a==r.length-1?s:Math.floor(c*i);e=e.concat(R([o,l],h),[l]),s-=h}return e}function kt(r,t="h",e=9,i="rgb",s=0,a=1,n=100){for(var o=vt(r),l=Gt(o),c=(a-s)*n/e,h=[],u=1;u<=e;u++)l[t]=Math.abs((n-c*u)/n),h.push(E(zt(l),i));return h}function Wr(r,t=9,e="rgb",i=0,s=360){return kt(r,"h",t,e,i,s,1)}function qr(r,t=9,e="rgb",i=0,s=1){return kt(r,"s",t,e,i,s,100)}function Jr(r,t=9,e="rgb",i=0,s=1){return kt(r,"v",t,e,i,s,100)}R.parula=function(r){return R(["#352a87","#0f5cdd","#00b5a6","#ffc337","#fdff00"],r)},R.jet=function(r){return R(["#00008f","#0020ff","#00ffff","#51ff77","#fdff00","#ff0000","#800000"],r)},R.hsv=function(r){return R(["#ff0000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff0000"],r)},R.hot=function(r){return R(["#0b0000","#ff0000","#ffff00","#ffffff"],r)},R.pink=function(r){return R(["#1e0000","#bd7b7b","#e7e5b2","#ffffff"],r)},R.bone=function(r){return R(["#000000","#4a4a68","#a6c6c6","#ffffff"],r)},R.copper=function(r){return R(["#000000","#3d2618","#9d623e","#ffa167","#ffc77f"],r)};var Zr={interpolateRGB:xe,blend:Kt,mix:zr,scale:R,contrast:ye,contrastColor:Kr,gradient:jr,scaleHSV:kt,scaleH:Wr,scaleS:qr,scaleV:Jr};function Qr(r,t){if(r.length!==t.length)return!1;for(var e=0,i=r.length;e<i;++e)if(r[e]!==t[e])return!1;return!0}function ti(r,t){for(var e=0,i=0,s=r.length;i<s;i++)e+=Math.pow(t[i]-r[i],2);return Math.sqrt(e)}function ei(r,t){for(var e=0,i=0,s=r.length;i<s;i++)e+=Math.abs(t[i]-r[i]);return e}function ri(r,t){for(var e=0,i=0,s=r.length;i<s;i++)e=Math.max(e,Math.abs(t[i]-r[i]));return e}const ii={euclidean:ti,manhattan:ei,max:ri},si={linear:function(r,t){var e=[],i=Math.round(Math.random()*r),s=Math.floor(r/t);do e.push(i),i=(i+s)%r;while(e.length<t);return e},shuffle:function(r,t){for(var e=[];e.length<t;){var i=Math.round(Math.random()*r);e.indexOf(i)==-1&&e.push(i)}return e}};function ai(r,t,e="linear"){var i=si[e](r.length,t);return i.map(s=>r[s])}function ni(r,t,e){var i=1/0,s=0;return t.forEach((a,n)=>{var o=e(r,a);o<i&&(i=o,s=n)}),s}function oi(r){if(!r.length)return[];let t=new Array(r[0].length);for(var e=0,i=t.length;e<i;e++)t[e]=0;for(var s=0,i=r.length;s<i;s++)for(var a=r[s],n=s+1,o=0,l=a.length;o<l;o++)t[o]+=(a[o]-t[o])/n;return t=t.map(c=>Math.floor(c)),t}function Ta(r){return r}function li(r,t,e,i){let s=new Array(r);for(var a=0;a<r;a++)s[a]=[];for(var n=0,o=t.length;n<o;n++){var l=t[n],c=ni(l,e,i);s[c].push(l)}return s}function ci(r,t,e,i,s,a){for(var n=0;n<r;n++){let l=e[n];const c=i[n];let h=new Array(c.length);if(l.length>0)h=oi(l);else{var o=Math.floor(a()*t.length);h=t[o]}Qr(h,c)?s=!1:s=!0,i[n]=h}return s}function hi(r,t,e,i=10,s="linear"){r=r,t=t||Math.max(2,Math.ceil(Math.sqrt(r.length/2)));let a=e||"euclidean";typeof a=="string"&&(a=ii[a]);var n=0,o=function(){return n=(n*9301+49297)%233280,n/233280};let l=ai(r,t,s),c=!0,h=0;for(;c;){const u=li(t,r,l,a);if(c=ci(t,r,u,l,!1,o),h++,h%i==0)break}return l}function ui(r,t){for(var e=0;e<r;e+=4)t(e)}function fi(r,t){ui(r.pixels.length,e=>{t(r.pixels,e)})}const rt={create(r,t){var e=document.createElement("canvas");return e.width=r||0,e.height=t||0,e},drawPixels(r){var t=this.create(r.width,r.height),e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height);return i.data.set(r.pixels),e.putImageData(i,0,0),t},createHistogram(r,t,e,i,s={black:!0,red:!1,green:!1,blue:!1}){var a=this.create(r,t);const n=a.getContext("2d");n.clearRect(0,0,r,t),n.fillStyle="white",n.fillRect(0,0,r,t),n.globalAlpha=.7;var o={black:!1};s.black?o.black=!1:o.black=!0,s.red?o.red=!1:o.red=!0,s.green?o.green=!1:o.green=!0,s.blue?o.blue=!1:o.blue=!0,Object.keys(e).forEach(l=>{if(!o[l]){var c=e[l];const h=Math.max.apply(Math,c),u=r/c.length;n.fillStyle=l,c.forEach((d,g)=>{const p=t*(d/h),v=g*u;n.fillRect(v,t-p,u,p)})}}),typeof i=="function"&&i(a)},getHistogram(r){let t=new Array(256),e=new Array(256),i=new Array(256),s=new Array(256);for(var a=0;a<256;a++)t[a]=0,e[a]=0,i[a]=0,s[a]=0;return fi(r,(n,o)=>{const l=Math.round(C.brightness(n[o],n[o+1],n[o+2]));t[l]++,e[n[o]]++,i[n[o+1]]++,s[n[o+2]]++}),{black:t,red:e,green:i,blue:s}},getBitmap(r,t){var e=this.drawPixels(r),i=e.getContext("2d"),s=i.getImageData(t.x||0,t.y||0,t.width||e.width,t.height||e.height).data;return{pixels:s,width:t.width,height:t.height}},putBitmap(r,t,e){var i=this.drawPixels(r),s=this.drawPixels(t),a=i.getContext("2d");return a.drawImage(s,e.x,e.y),r.pixels=a.getImageData(0,0,r.width,r.height).data,r}};class ot{constructor(t,e={}){this.isLoaded=!1,this.imageUrl=t,this.opt=e,this.initialize()}initialize(){this.canvas=this.createCanvas(),this.context=this.canvas.getContext("2d")}createCanvas(){return document.createElement("canvas")}load(t){this.loadImage(t)}loadImage(t){var e=this.context;this.newImage=new Image;const i=this.newImage;i.onload=()=>{var s=i.height/i.width;this.opt.canvasWidth&&this.opt.canvasHeight?(this.canvas.width=this.opt.canvasWidth,this.canvas.height=this.opt.canvasHeight):(this.canvas.width=this.opt.maxWidth?this.opt.maxWidth:i.width,this.canvas.height=this.canvas.width*s),e.drawImage(i,0,0,i.width,i.height,0,0,this.canvas.width,this.canvas.height),this.isLoaded=!0,t&&t()},this.getImageUrl(function(s){i.src=s})}load(t){this.newImage=new Image;const e=this.newImage;e.onload=()=>{this.isLoaded=!0,t&&t()},this.getImageUrl(function(i){e.src=i})}getImageUrl(t){if(typeof this.imageUrl=="string")return t(this.imageUrl);if(this.imageUrl instanceof Blob){var e=new FileReader;e.onload=function(i){t(i.target.result)},e.readAsDataURL(this.imageUrl)}}getRGBA(t,e,i,s){return[t,e,i,s]}toArray(t,e,i={}){var s=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),a=s.width,n=s.height,o=new Uint8ClampedArray(s.data);let l={pixels:o,width:a,height:n};t||(t=function(){return(c,h)=>{h(c)}}()),t(l,function(c){var h=rt.drawPixels(c);i.returnTo=="canvas"?e(h):e(h.toDataURL(i.outputFormat||"image/png"))},i)}toHistogram(t){var e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=e.width,s=e.height,a=new Uint8ClampedArray(e.data);let n={pixels:a,width:i,height:s};return rt.getHistogram(n)}toRGB(){for(var t=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),e=t.data,i=[],s=0,a=e.length;s<a;s+=4)i[i.length]=[e[s+0],e[s+1],e[s+2],e[s+3]];return i}}function di(r,t=6,e="hex"){return r.length>t&&(r=hi(r,t)),r.map(i=>E(i,e))}function gi(r,t={},e){if(e){if(e){var i=new ot(r,t);i.loadImage(()=>{typeof e=="function"&&e(i.toRGB())})}}else{var i=new ot(r);i.loadImage(()=>{typeof t=="function"&&t(i.toRGB())})}}function pi(r,t,e,i={frameTimer:"full"}){we(r,t,e,Object.assign({returnTo:"canvas"},i))}function we(r,t,e,i={frameTimer:"full"}){var s=new ot(r);s.loadImage(()=>{s.toArray(t,function(a){typeof e=="function"&&e(a)},i)})}function vi(r,t,e={}){var i=new ot(r);i.loadImage(()=>{typeof t=="function"&&t(i.toHistogram(e))})}function $i(r,t=.2){var e=[];for(let g=0;g<r.length;g++){var i=r[g];if(g==0){e[g]=[];continue}if(g==r.length-1){e[g]=[];continue}var s=r[g-1],a=r[g+1];(a[1]-s[1])/(a[0]-s[0]);var n=[s[0]+(a[0]-s[0])*t,s[1]+(a[1]-s[1])*t],o=[[...s],[...n]],l=Math.sqrt(Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2)),c=Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2)),h=l/c,u=o[0][0]+(o[1][0]-o[0][0])*h,d=o[0][1]+(o[1][1]-o[0][1])*h;o[0][0]+=i[0]-u,o[0][1]+=i[1]-d,o[1][0]+=i[0]-u,o[1][1]+=i[1]-d,e[g]=o}return e}function mi(r,t,e={width:200,height:100}){var i=new ot(r);i.loadImage(()=>{rt.createHistogram(e.width||200,e.height||100,i.toHistogram(e),function(s){typeof t=="function"&&t(s.toDataURL("image/png"))},e)})}var Ci={palette:di,ImageToCanvas:pi,ImageToHistogram:mi,ImageToRGB:gi,ImageToURL:we,histogram:vi,histogramToPoints:$i},C=$($($($($($($($($($($({},wr),kr),Zr),Dr),Yr),Ar),Fr),Xr),Pr),Lr),Ci);function it(r){return typeof r=="undefined"||r===null}function T(r){return it(r)===!1}function Mt(r){return typeof r=="string"}function jt(r){return typeof r=="function"}function Se(r){return typeof r=="number"}const A=[{rgb:"#ff0000",start:0},{rgb:"#ffff00",start:.17},{rgb:"#00ff00",start:.33},{rgb:"#00ffff",start:.5},{rgb:"#0000ff",start:.67},{rgb:"#ff00ff",start:.83},{rgb:"#ff0000",start:1}];function Wt(r){for(var t,e,i=0;i<A.length;i++)if(A[i].start>=r){t=A[i-1],e=A[i];break}return t&&e?C.mix(t.rgb,e.rgb,(r-t.start)/(e.start-t.start)):A[0].rgb}function bi(r,t=.1,e){const i=it(e)?r-t:t,s=it(e)?r+scale:e,a=[];for(var n=0;n<A.length;n++){const o=A[n];i<=o.start&&o.start<s?a.push({rgb:o.rgb,start:o.start}):A[n+1]&&o.start<i&&i<A[n+1].start?a.push({rgb:Wt(i),start:i}):A[n-1]&&A[n-1].start<s&&s<o.start?a.push({rgb:Wt(s),start:s}):o.start<i||o.start>s||a.push({rgb:o.rgb,start:o.start})}return a}function xi(){for(var r=0,t=A.length;r<t;r++){var e=A[r],i=C.parse(e.rgb);e.r=i.r,e.g=i.g,e.b=i.b}}xi();var qt={colors:A,checkHueColor:Wt,getHueScale:bi};const st={identity(){return[1,0,0,0,1,0,0,0,1]},stretching(r){return[r,0,0,0,1,0,0,0,1]},squeezing(r){return[r,0,0,0,1/r,0,0,0,1]},scale(r=1,t=1){return r=r||r===0?r:1,t=t||t===0?t:1,[r,0,0,0,t,0,0,0,1]},scaleX(r){return this.scale(r)},scaleY(r){return this.scale(1,r)},translate(r,t){return[1,0,r,0,1,t,0,0,1]},rotate(r){const t=this.radian(r);return[Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1]},rotate90(){return[0,-1,0,1,0,0,0,0,1]},rotate180(){return[-1,0,0,0,-1,0,0,0,1]},rotate270(){return[0,1,0,-1,0,0,0,0,1]},radian(r){return r*Math.PI/180},skew(r,t){const e=this.radian(r),i=this.radian(t);return[1,Math.tan(e),0,Math.tan(i),1,0,0,0,1]},skewX(r){const t=this.radian(r);return[1,Math.tan(t),0,0,1,0,0,0,1]},skewY(r){const t=this.radian(r);return[1,0,0,Math.tan(t),1,0,0,0,1]},shear1(r){return[1,-Math.tan(this.radian(r)/2),0,0,1,0,0,0,1]},shear2(r){return[1,0,0,Math.sin(this.radian(r)),1,0,0,0,1]}},z={CONSTANT:st,radian(r){return st.radian(r)},multiply(r,t){return[r[0]*t[0]+r[1]*t[1]+r[2]*t[2],r[3]*t[0]+r[4]*t[1]+r[5]*t[2],r[6]*t[0]+r[7]*t[1]+r[8]*t[2]]},identity(r){return this.multiply(st.identity(),r)},translate(r,t,e){return this.multiply(st.translate(r,t),e)},rotate(r,t){return this.multiply(st.rotate(r),t)},shear1(r,t){return this.multiply(st.shear1(r),t)},shear2(r,t){return this.multiply(st.shear2(r),t)},rotateShear(r,t){let e=t;return e=this.shear1(r,e),e=this.shear2(r,e),e=this.shear1(r,e),e}};function yi(r=0,t=0,e,i){const s=at(e*i*4,e,i);return function(a,n,o={}){for(var l=t,c=0;l<i;l++,c++)for(var h=r,u=0;h<e;h++,u++)s.pixels[c*e*u]=a.pixels[l*e*h];n(s)}}function wi(r,t){return function(e,i,s={}){var a=rt.drawPixels(e),n=a.getContext("2d");a.width=r,a.height=t,i({pixels:new Uint8ClampedArray(n.getImageData(0,0,r,t).data),width:r,height:t})}}function Si(){return function(r,t,e={}){const i=r.width,s=r.height,n=(s%2==1?1:0)?Math.floor(s/2):s/2;for(var o=0;o<n;o++)for(var l=0;l<i;l++){var c=o*i+l<<2,h=(s-1-o)*i+l<<2;We(r.pixels,c,h)}t(r)}}function ki(){return function(r,t,e={}){const i=r.width,s=r.height,n=(i%2==1?1:0)?Math.floor(i/2):i/2;for(var o=0;o<s;o++)for(var l=0;l<n;l++){var c=o*i+l<<2,h=o*i+(i-1-l)<<2;We(r.pixels,c,h)}t(r)}}function Jt(r,t="center",e="center"){return function(i,s,a={}){var n=at(i.pixels.length,i.width,i.height);const o=i.width,l=i.height;t=="center"&&(t=Math.floor(o/2)),e=="center"&&(e=Math.floor(l/2));const c=z.CONSTANT.translate(-t,-e),h=z.CONSTANT.translate(t,e),u=z.CONSTANT.shear1(r),d=z.CONSTANT.shear2(r);Zt((g,p,v,b)=>{let w=z.multiply(c,[v,b,1]);w=z.multiply(u,w).map(Math.round),w=z.multiply(d,w).map(Math.round),w=z.multiply(u,w).map(Math.round),w=z.multiply(h,w);const[k,M]=w;if(!(k<0)&&!(M<0)&&!(k>o-1)&&!(M>l-1)){var Y=M*o+k<<2;te(g,Y,i.pixels,p)}})(n,function(){s(n)},a)}}function Mi(r=0){return r=m(r),r=r%360,function(t,e,i={}){if(r==0)return t;if(r==90||r==270)var s=at(t.pixels.length,t.height,t.width);else if(r==180)var s=at(t.pixels.length,t.width,t.height);else return Jt(r)(t,e,i);Zt((a,n,o,l)=>{if(r==90)var c=o*s.width+(s.width-1-l)<<2;else if(r==270)var c=(s.height-1-o)*s.width+l<<2;else if(r==180)var c=(s.height-1-l)*s.width+(s.width-1-o)<<2;te(s.pixels,c,t.pixels,n)})(t,function(){e(s)},i)}}function Ei(r="gray",t=[]){for(var e=[],i=0;i<t.length-1;i++)for(var s=t[i],a=t[i+1],n=a[0]-s[0],o=a[1]-s[1],l=o/n,c=0,h=s[0];c<n;c++,h++)e[h]=s[1]+c*l;return e[255]=255,r==="red"?x(()=>{$r=e[$r]},{},{$realPoints:e}):r==="green"?x(()=>{$g=e[$g]},{},{$realPoints:e}):r==="blue"?x(()=>{$b=e[$b]},{},{$realPoints:e}):x(()=>{const u=Color.RGBtoYCrCb($r,$g,$b),d=Color.YCrCbtoRGB(clamp(e[clamp(u.y)]),u.cr,u.cb,0);$r=d.r,$g=d.g,$b=d.b},{},{$realPoints:e})}var Ii={crop:yi,resize:wi,flipH:ki,flipV:Si,rotate:Mi,rotateDegree:Jt,histogram:Ei,"rotate-degree":Jt};function Pi(r,t,e=100){let i=C.parse(r),s=C.parse(t);return x(`        
        const thresholdColor = ( $r + $g + $b ) <= $threshold ? $darkColor : $lightColor

        $r = thresholdColor.r;
        $g = thresholdColor.g;
        $b = thresholdColor.b; 
    `,{$threshold:e},{$darkColor:i,$lightColor:s})}function Ti(r=1){r=m(r);const t=Math.floor(255*(r/100));return x(`
        $r += $C;
        $g += $C;
        $b += $C;
    `,{$C:t})}function Di(){return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        
    `,{$matrix:[.5997023498159715,.34553243048391263,-.2708298674538042,0,-.037703249837783157,.8609577587992641,.15059552388459913,0,.24113635128153335,-.07441037908422492,.44972182064877153,0,0,0,0,1]})}function Ui(r=0){r=m(r);const t=Math.abs(r)*2.55;return x(`

        $r = ($r > 255 - $C) ? 255 : 0;
        $g = ($g > 255 - $C) ? 255 : 0;
        $b = ($b > 255 - $C) ? 255 : 0;

    `,{$C:t})}function Ri(r=0){r=m(r);const t=Math.max((128+r)/128,0);return x(`
        $r *= $C;
        $g *= $C;
        $b *= $C;
    `,{$C:t})}function Vi(r=1){const t=m(r);return x(`
        $r = Math.pow($r / 255, $C) * 255;
        $g = Math.pow($g / 255, $C) * 255;
        $b = Math.pow($b / 255, $C) * 255;
    `,{$C:t})}function Hi(){let r=[...arguments];r.length===1&&typeof r[0]=="string"&&(r=C.convertMatchesArray(r[0])),r=r.map(i=>C.matches(i).length?{type:"param",value:i}:{type:"scale",value:i});let t=r.filter(i=>i.type=="scale")[0];t=t?+t.value:256,r=r.filter(i=>i.type=="param").map(i=>i.value).join(",");let e=C.gradient(r,t).map(i=>{const{r:s,g:a,b:n,a:o}=C.parse(i);return{r:s,g:a,b:n,a:o}});return x(`
        const colorIndex = clamp(Math.ceil($r * 0.2126 + $g * 0.7152 + $b * 0.0722));
        const newColorIndex = clamp(Math.floor(colorIndex * ($scale / 256)));
        const color = $colors[newColorIndex];

        $r = color.r; 
        $g = color.g; 
        $b = color.b; 
        $a = clamp(Math.floor(color.a * 256));
    `,{},{$colors:e,$scale:t})}function Oi(r){r=m(r);let t=r/100;t>1&&(t=1);const e=[.2126+.7874*(1-t),.7152-.7152*(1-t),.0722-.0722*(1-t),0,.2126-.2126*(1-t),.7152+.2848*(1-t),.0722-.0722*(1-t),0,.2126-.2126*(1-t),.7152-.7152*(1-t),.0722+.9278*(1-t),0,0,0,0,1];return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;
    `,{$matrix:e})}function Ai(r=360){const t=m(r);return x(`
        var hsv = Color.RGBtoHSV($r, $g, $b);

        // 0 ~ 360 
        var h = hsv.h;
        h += Math.abs($C);
        h = h % 360;
        hsv.h = h;

        var rgb = Color.HSVtoRGB(hsv);

        $r = rgb.r;
        $g = rgb.g;
        $b = rgb.b;
    `,{$C:t})}function Ni(r=100){r=m(r);const t=r/100;return x(`
        $r = (255 - $r) * $C;
        $g = (255 - $g) * $C;
        $b = (255 - $b) * $C;
    `,{$C:t})}function Fi(){return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;
    `,{$matrix:[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,0,0,0,1]})}function Bi(r=0,t=0,e=0,i=0,s=0,a=0,n=0,o=0,l=0,c=0,h=0,u=0,d=0,g=0,p=0,v=0){return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;
    `,{$matrix:[r,t,e,i,s,a,n,o,l,c,h,u,d,g,p,v]})}function Li(r=1){const t=m(r);return x(`
        const C = Math.abs($C) * 5;
        const min = -C;
        const max = C;
        const noiseValue = Math.round(min + (Math.random() * (max - min)));

        $r += noiseValue;
        $g += noiseValue;
        $b += noiseValue;
    `,{$C:t})}function Gi(r=100){r=m(r);const t=r/100;return x(`
        $a *= $C; 
    `,{$C:t})}function Xi(){return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;
    `,{$matrix:[1.438,-.062,-.062,0,-.122,1.378,-.122,0,-.016,-.016,1.483,0,0,0,0,1]})}function _i(r=100){r=m(r);const t=r/100,e=1-Math.abs(t);return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        
    `,{$matrix:[e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,e]})}function Yi(r=1){let t=m(r);t>1&&(t=1);const e=[.393+.607*(1-t),.769-.769*(1-t),.189-.189*(1-t),0,.349-.349*(1-t),.686+.314*(1-t),.168-.168*(1-t),0,.272-.272*(1-t),.534-.534*(1-t),.131+.869*(1-t),0,0,0,0,1];return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        
    `,{$matrix:e})}function zi(r=1,t=1,e=1){const i=m(r),s=m(t),a=m(e);return x(`
        $r *= $redValue;
        $g *= $greenValue;
        $b *= $blueValue;
    `,{$redValue:i,$greenValue:s,$blueValue:a})}function Ki(){return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        
    `,{$matrix:[1.438,-.062,-.062,0,-.122,1.378,-.122,0,-.016,-.016,1.483,0,0,0,0,1]})}function ji(r,t,e){const i=m(r),s=m(t),a=m(e);return x(`
        $r = ($r < $redValue) ? 255 - $r: $r;
        $g = ($g < $greenValue) ? 255 - $g: $g;
        $b = ($b < $blueValue) ? 255 - $b: $b;
    `,{$redValue:i,$greenValue:s,$blueValue:a})}function Wi(){return x(`
        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;
        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;
        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;
        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;
    `,{$matrix:[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-.231103377548616,-.7501899197440212,1.847597816108189,0,0,0,0,1]})}function ke(r=200,t=100,e=!0){const i=m(r);t=m(t);const s=t/100;return x(`
        // refer to Color.brightness 
        const v = ($C * Math.ceil($r * 0.2126 + $g * 0.7152 + $b * 0.0722) ) >= $scale ? 255 : 0;

        if ($hasColor) {

            if (v == 0) {
                $r = 0; 
                $g = 0; 
                $b = 0;
            }
            
        } else {
            const value = Math.round(v);
            $r = value; 
            $g = value;
            $b = value; 
        }
        
    `,{$C:s,$scale:i,$hasColor:e})}function qi(r=200,t=100){return ke(r,t,!1)}function Ji(r=1,t=1,e=1){const i=m(r),s=m(t),a=m(e);return x(`

        $r += (255 - $r) * $redTint;
        $g += (255 - $g) * $greenTint;
        $b += (255 - $b) * $blueTint;

    `,{$redTint:i,$greenTint:s,$blueTint:a})}var Zi={bitonal:Pi,brightness:Ti,brownie:Di,clip:Ui,contrast:Ri,gamma:Vi,gradient:Hi,grayscale:Oi,hue:Ai,invert:Ni,kodachrome:Fi,matrix:Bi,noise:Li,opacity:Gi,polaroid:Xi,saturation:_i,sepia:Yi,shade:zi,shift:Ki,solarize:ji,technicolor:Wi,threshold:qi,"threshold-color":ke,tint:Ji};function Qi(r=3,t=!0){return r=m(r),I(qe(r))}function ts(r=4){return r=m(r),I([r*-2,-r,0,-r,1,r,0,r,r*2])}function Me(r=100){r=m(r);const t=r/100;return I(N([1,2,1,2,4,2,1,2,1],1/16*t))}function Ee(r=100){r=m(r);const t=r/100;return I(N([1,4,6,4,1,4,16,24,16,4,6,24,36,24,6,4,16,24,16,4,1,4,6,4,1],1/256*t))}function es(r=100){return r=m(r),I(N([.3,.3,.3,0,0,.59,.59,.59,0,0,.11,.11,.11,0,0,0,0,0,0,0,0,0,0,0,0],r/100))}function rs(){return I([0,0,0,0,1,0,0,0,0])}function Ie(r=1){return r=m(r),I([5,5,5,-3,0,-3,-3,-3,-3])}function Pe(r=1){return r=m(r),I([5,-3,-3,5,0,-3,5,-3,-3])}function is(r=100){return r=m(r),I(N([-1,-1,-1,-1,8,-1,-1,-1,-1],r/100))}function Te(r=100){return r=m(r),I(N([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],r/100))}function De(){return I(N([1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1],1/9))}function Ue(){return I(N([1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1],1/9))}function Re(){return I(N([1,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,0,0,1,0,1,0,1,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0,1,0,0,0,1],1/9))}function ss(r=100){return r=m(r),I(N([-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,1,0,1,1,1,1,1],r/100))}function as(r=100){return r=m(r),I(N([.393,.349,.272,0,0,.769,.686,.534,0,0,.189,.168,.131,0,0,0,0,0,0,0,0,0,0,0,0],r/100))}function ns(r=100){return r=m(r),I(N([0,-1,0,-1,5,-1,0,-1,0],r/100))}function Ve(){return I([-1,-2,-1,0,0,0,1,2,1])}function He(){return I([-1,0,1,-2,0,2,-1,0,1])}var os=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ls=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Oe(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function cs(r,t,e){return e?hs(r,0,0,t):stackBlurCanvasRGB(r,0,0,t)}function hs(r,t,e,i){if(isNaN(i)||i<1)return r;i|=0;const{pixels:s,width:a,height:n}=r;var o,l,c,h,u,d,g,p,v,b,w,k,M,Y,q,J,B,L,G,ut,Sa=i+i+1,Ft=a-1,ne=n-1,H=i+1,ft=H*(H+1)/2,dt=new Oe,y=dt;for(c=1;c<Sa;c++)if(y=y.next=new Oe,c==H)var br=y;y.next=dt;var D=null,_=null;g=d=0;var gt=os[i],pt=ls[i];for(l=0;l<n;l++){for(Y=q=J=p=v=b=0,w=H*(B=s[d]),k=H*(L=s[d+1]),M=H*(G=s[d+2]),p+=ft*B,v+=ft*L,b+=ft*G,y=dt,c=0;c<H;c++)y.r=B,y.g=L,y.b=G,y=y.next;for(c=1;c<H;c++)h=d+((Ft<c?Ft:c)<<2),p+=(y.r=B=s[h])*(ut=H-c),v+=(y.g=L=s[h+1])*ut,b+=(y.b=G=s[h+2])*ut,Y+=B,q+=L,J+=G,y=y.next;for(D=dt,_=br,o=0;o<a;o++)s[d]=p*gt>>pt,s[d+1]=v*gt>>pt,s[d+2]=b*gt>>pt,p-=w,v-=k,b-=M,w-=D.r,k-=D.g,M-=D.b,h=g+((h=o+i+1)<Ft?h:Ft)<<2,Y+=D.r=s[h],q+=D.g=s[h+1],J+=D.b=s[h+2],p+=Y,v+=q,b+=J,D=D.next,w+=B=_.r,k+=L=_.g,M+=G=_.b,Y-=B,q-=L,J-=G,_=_.next,d+=4;g+=a}for(o=0;o<a;o++){for(q=J=Y=v=b=p=0,d=o<<2,w=H*(B=s[d]),k=H*(L=s[d+1]),M=H*(G=s[d+2]),p+=ft*B,v+=ft*L,b+=ft*G,y=dt,c=0;c<H;c++)y.r=B,y.g=L,y.b=G,y=y.next;for(u=a,c=1;c<=i;c++)d=u+o<<2,p+=(y.r=B=s[d])*(ut=H-c),v+=(y.g=L=s[d+1])*ut,b+=(y.b=G=s[d+2])*ut,Y+=B,q+=L,J+=G,y=y.next,c<ne&&(u+=a);for(d=o,D=dt,_=br,l=0;l<n;l++)h=d<<2,s[h]=p*gt>>pt,s[h+1]=v*gt>>pt,s[h+2]=b*gt>>pt,p-=w,v-=k,b-=M,w-=D.r,k-=D.g,M-=D.b,h=o+((h=l+H)<ne?h:ne)*a<<2,p+=Y+=D.r=s[h],v+=q+=D.g=s[h+1],b+=J+=D.b=s[h+2],D=D.next,w+=B=_.r,k+=L=_.g,M+=G=_.b,Y-=B,q-=L,J-=G,_=_.next,d+=a}return r}function Ae(r=10,t=!0){return r=m(r),function(e,i,s={}){let a=cs(e,r,t);i(a)}}function us(r=100){return r=m(r),I(N([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,.3,0,0,0,0,0,1],r/100))}function Ne(r=256){return r=m(r),I(N([1,4,6,4,1,4,16,24,16,4,6,24,-476,24,6,4,16,24,16,4,1,4,6,4,1],-1/r))}var fs={blur:Qi,emboss:ts,gaussianBlur:Me,"gaussian-blur":Me,gaussianBlur5x:Ee,"gaussian-blur-5x":Ee,grayscale2:es,normal:rs,kirschHorizontal:Ie,"kirsch-horizontal":Ie,kirschVertical:Pe,"kirsch-vertical":Pe,laplacian:is,laplacian5x:Te,"laplacian-5x":Te,motionBlur:De,"motion-blur":De,motionBlur2:Ue,"motion-blur-2":Ue,motionBlur3:Re,"motion-blur-3":Re,negative:ss,sepia2:as,sharpen:ns,sobelHorizontal:Ve,"sobel-horizontal":Ve,sobelVertical:He,"sobel-vertical":He,stackBlur:Ae,"stack-blur":Ae,transparency:us,unsharpMasking:Ne,"unsharp-masking":Ne};function ds(){return $t("kirsch-horizontal kirsch-vertical")}function gs(){return $t("sobel-horizontal sobel-vertical")}function ps(){return $t("brightness(15) saturation(-20) gamma(1.8)")}var vs={kirsch:ds,sobel:gs,vintage:ps},Fe=$($($($({},Ii),Zi),fs),vs);let Be=0;const Le={partial:tr,multi:ee,merge:Et,weight:N,repeat:Ge,colorMatrix:ms,each:_e,eachXY:Ye,createRandomCount:xs,createRandRange:bs,createBitmap:at,createBlurMatrix:qe,pack:ks,packXY:Zt,pixel:x,getBitmap:ze,putBitmap:Ke,radian:Ts,convolution:I,parseParamNumber:m,filter:$t,clamp:Qe,fillColor:Qt,fillPixelColor:te,multi:ee,merge:Et,matches:Je,parseFilter:Ze,partial:tr},$s=Le;function N(r,t=1){return r.map(e=>e*t)}function Ge(r,t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=r;return e}function ms(r,t,e){var i=r[t],s=r[t+1],a=r[t+2],n=r[t+3];Qt(r,t,e[0]*i+e[1]*s+e[2]*a+e[3]*n,e[4]*i+e[5]*s+e[6]*a+e[7]*n,e[8]*i+e[9]*s+e[10]*a+e[11]*n,e[12]*i+e[13]*s+e[14]*a+e[15]*n)}function Cs(r){if(typeof r=="function")return r;typeof r=="string"&&(r=[r]),r=r.slice(0);const t=r.shift();if(typeof t=="function")return t;const e=r,i=Fe[t]||$s[t];if(!i)throw new Error(`${t} is not filter. please check filter name.`);return i.apply(i,e)}function Xe(r,t=0,e=1,i,s,a=1e4,n="full",o=50){let l=t,c=g=>{setTimeout(g,0)};n=="requestAnimationFrame"&&(c=requestAnimationFrame,a=1e3),n=="full"&&(c=null,a=r);function h(g=50){const v=[...Array(g)].map(w=>"cri = ri + i * s; if (cri >= mx) return {currentRunIndex: cri, i: null}; c(cri); i++;").join(`
`);return new Function("ri","i","s","mx","c",`
            let cri = ri;
            
            ${v}
            
            return {currentRunIndex: cri, i: i} 
        `)}function u(){const g=h(o);let p=l,v={},b=0;for(;b<a;){if(v=g(l,b,e,r,i),v.i==null){p=v.currentRunIndex;break}b=v.i,p=v.currentRunIndex}d(p)}function d(g){if(g?l=g:l+=e,l>=r){s();return}c?c(u):u()}u()}function _e(r,t,e,i={}){Xe(r,0,4,function(s){t(s,s>>2)},function(){e()},i.functionDumpCount,i.frameTimer,i.loopCount)}function Ye(r,t,e,i,s={}){Xe(r,0,4,function(a){var n=a>>2;e(a,n%t,Math.floor(n/t))},function(){i()},s.functionDumpCount,s.frameTimer,s.loopCount)}function bs(r,t,e){for(var i=[],s=1;s<=e;s++){var a=Math.random()*(t-r)+r,n=Math.floor(Math.random()*10)%2==0?-1:1;i.push(n*a)}i.sort();const o=Math.floor(e>>1);var l=i[o];return i[o]=i[0],i[0]=l,i}function xs(){return[3*3,4*4,5*5,6*6,7*7,8*8,9*9,10*10].sort(function(r,t){return .5-Math.random()})[0]}function at(r,t,e){return{pixels:new Uint8ClampedArray(r),width:t,height:e}}function ys(r,t,e,i){for(var s=t.pixels.length/4,a=0,n=0,o=0,l=0,c=0,h=0,u=0;u<s;u++)o=u%t.width,l=Math.floor(u/t.width),a=e+o,n=i+l,!(a>r.width)&&(n>r.height||(c=l*t.width+o<<2,h=n*r.width+a<<2,r.pixels[h]=t.pixels[c],r.pixels[h+1]=t.pixels[c+1],r.pixels[h+2]=t.pixels[c+2],r.pixels[h+3]=t.pixels[c+3]))}function ws(r,t,e,i){for(var s=t.pixels.length>>2,a=0,n=0,o=0,l=0,c=0,h=0,u=0;u<s;u++){var o=u%t.width,l=Math.floor(u/t.width);a=e+o,n=i+l,!(a>r.width)&&(n>r.height||(c=n*r.width+a<<2,h=l*t.width+o<<2,t.pixels[h]=r.pixels[c],t.pixels[h+1]=r.pixels[c+1],t.pixels[h+2]=r.pixels[c+2],t.pixels[h+3]=r.pixels[c+3]))}}function Ss(r,t=0){const e=r.width+t,i=r.height+t;return{pixels:new Uint8ClampedArray(e*i*4),width:e,height:i}}function ze(r,t){return rt.getBitmap(r,t)}function Ke(r,t,e){return rt.putBitmap(r,t,e)}function m(r){return typeof r=="string"&&(r=r.replace(/deg/,""),r=r.replace(/px/,"")),+r}const je=/(([\w_\-]+)(\(([^\)]*)\))?)+/gi;function ks(r){return function(t,e){_e(t.pixels.length,(i,s)=>{r(t.pixels,i,s,t.pixels[i],t.pixels[i+1],t.pixels[i+2],t.pixels[i+3])},function(){e(t)})}}function Ms(r){const t=r.map(n=>` 
            ${n.userFunction.$preContext}

            ${n.userFunction.$preCallbackString}

            $r = clamp($r); $g = clamp($g); $b = clamp($b); $a = clamp($a);
        `).join(`

`);var e={clamp:Qe,Color:C};r.forEach(n=>{Object.assign(e,n.userFunction.rootContextObject)});var i="const "+Object.keys(e).map(n=>` ${n} = $rc.${n} `).join(",");let s=` 
    let $r = $p[$pi], $g = $p[$pi+1], $b = $p[$pi+2], $a = $p[$pi+3];
    
    ${i}

    ${t}
    
    $p[$pi] = $r; $p[$pi+1] = $g; $p[$pi+2] = $b; $p[$pi+3] = $a;
    `;const a=new Function("$p","$pi","$rc",s);return function(n,o){a(n,o,e)}}function Es(r){let t={};const e=r.map(o=>{let l=[];Object.keys(o.context).forEach((u,d)=>{l[u]=`n$${Be++}${u}$`}),Object.keys(o.rootContext).forEach((u,d)=>{l[u]=`r$${Be++}${u}$`,t[l[u]]=o.rootContext[u]});let c=Object.keys(o.context).filter(u=>typeof o.context[u]=="number"||typeof o.context[u]=="string"?!1:!(Array.isArray(o.context[u])&&(typeof o.context[u][0]=="number"||typeof o.context[u][0]=="string"))).map((u,d)=>[l[u],JSON.stringify(o.context[u])].join(" = ")),h=o.callback;return typeof o.callback=="function"&&(h=o.callback.toString().split("{"),h.shift(),h=h.join("{"),h=h.split("}"),h.pop(),h=h.join("}")),Object.keys(l).forEach(u=>{var d=l[u];typeof o.context[u]=="number"||typeof o.context[u]=="string"?h=h.replace(new RegExp("\\"+u,"g"),o.context[u]):Array.isArray(o.context[u])?typeof o.context[u][0]=="number"||typeof o.context[u][0]=="string"?o.context[u].forEach((g,p)=>{h=h.replace(new RegExp("\\"+u+"\\["+p+"\\]","g"),g)}):h=h.replace(new RegExp("\\"+u,"g"),d):h=h.replace(new RegExp("\\"+u,"g"),d)}),{preCallbackString:h,preContext:c}}),i=e.map((o,l)=>o.preContext.length?`const ${o.preContext};`:"").join(`

`),s=e.map(o=>o.preCallbackString).join(`

`);let a=` 
    let $r = $pixels[$pixelIndex], $g = $pixels[$pixelIndex+1], $b = $pixels[$pixelIndex+2], $a = $pixels[$pixelIndex+3];

    ${i}

    ${s}
    
    $pixels[$pixelIndex] = $r
    $pixels[$pixelIndex+1] = $g 
    $pixels[$pixelIndex+2] = $b   
    $pixels[$pixelIndex+3] = $a   
    `;const n=new Function("$pixels","$pixelIndex","$clamp","$Color",a);return n.$preCallbackString=s,n.$preContext=i,n.rootContextObject=t,n}function Is(r,t={},e={}){return Es([{callback:r,context:t,rootContext:e}])}function x(r,t={},e={}){const i=Is(r,t,e),s=function(a,n){};return s.userFunction=i,s}const Ps=[0,1,2,3];function We(r,t,e){Ps.forEach(i=>{var s=r[t+i];r[t+i]=r[e+i],r[e+i]=s})}function Zt(r){return function(t,e,i={}){Ye(t.pixels.length,t.width,(s,a,n)=>{r(t.pixels,s,a,n)},function(){e(t)},i)}}function Ts(r){return z.CONSTANT.radian(r)}function qe(r=3){const t=Math.pow(r,2),e=1/t;return Ge(e,t)}function Qt(r,t,e,i,s,a){if(arguments.length==3)var{r:e,g:i,b:s,a}=arguments[2];typeof e=="number"&&(r[t]=e),typeof i=="number"&&(r[t+1]=i),typeof s=="number"&&(r[t+2]=s),typeof a=="number"&&(r[t+3]=a)}function te(r,t,e,i){Qt(r,t,e[i],e[i+1],e[i+2],e[i+3])}function Ds(r,t=0,e=255){var i=[];return i=r.map((s,a)=>[]),r.forEach((s,a)=>{if(s!=0){let n=i[a];for(var a=t;a<=e;a++)n[a]=s*a}}),i}function Us(r,t,e,i,s){const a=Math.round(Math.sqrt(r.length)),n=Math.floor(a/2),o=s?1:0;let l="let r = 0, g = 0, b = 0, a = 0, scy = 0, scx =0, si = 0; ",c=[],h=[],u=[],d=[];r.forEach((p,v)=>{const b=Math.floor(v/a),w=v%a,k=b-n,M=w-n;p!=0&&(c.push(`$t[${v}][$sp[(($sy + (${k})) * ${e} + ($sx + (${M}))) * 4]]`),h.push(`$t[${v}][$sp[(($sy + (${k})) * ${e} + ($sx + (${M}))) * 4 + 1]]`),u.push(`$t[${v}][$sp[(($sy + (${k})) * ${e} + ($sx + (${M}))) * 4 + 2]]`),d.push(`$t[${v}][$sp[(($sy + (${k})) * ${e} + ($sx + (${M}))) * 4 + 3]]`))}),l+=`r = ${c.join(" + ")}; g = ${h.join(" + ")}; b = ${u.join(" + ")}; a = ${d.join(" + ")};`,l+=`$dp[$di] = r; $dp[$di+1] = g;$dp[$di+2] = b;$dp[$di+3] = a + (${o})*(255-a); `;const g=new Function("$dp","$sp","$di","$sx","$sy","$t",l);return function(p,v,b,w,k){g(p,v,b,w,k,t)}}function I(r,t=!0){const e=Ds(r);return function(i,s,a={}){const n=Math.round(Math.sqrt(r.length)),o=n*2;let l=Ss(i,o);ys(l,i,n,n);let c=at(l.pixels.length,l.width,l.height),h=at(i.pixels.length,i.width,i.height);const u=Us(r,e,l.width,l.height,t);for(var d=i.pixels.length/4,g=0;g<d;g++){var p=g,v=p%i.width+n,b=Math.floor(p/i.width)+n;u(c.pixels,l.pixels,(b*l.width+v)*4,v,b)}ws(c,h,n,n),s(h)}}function Je(r){var t=C.convertMatches(r);const e=t.str.match(je);let i=[];if(!e)return i;i=e.map(a=>({filter:a,origin:C.reverseMatches(a,t.matches)}));var s={next:0};return i=i.map(a=>{const n=r.indexOf(a.origin,s.next);return a.startIndex=n,a.endIndex=n+a.origin.length,a.arr=Ze(a.origin),s.next=a.endIndex,a}).filter(a=>!!a.arr.length),i}function Ze(r){var t=C.convertMatches(r);const e=t.str.match(je);if(!e[0])return[];var i=e[0].split("("),s=i.shift(),a=[];i.length&&(a=i.shift().split(")")[0].split(",").map(o=>C.reverseMatches(o,t.matches)));var n=[s,...a].map(C.trim);return n}function Qe(r){return Math.min(255,r)}function $t(r){return Et(Je(r).map(t=>t.arr))}function Rs(r=[]){for(var t=[],e=[],i=0,s=r.length;i<s;i++){var a=r[i];a.userFunction?e.push(a):(e.length&&t.push([...e]),t.push(a),e=[])}return e.length&&t.push([...e]),t.forEach((n,o)=>{Array.isArray(n)&&(t[o]=function(){const l=Ms(n);return function(c,h){for(var u=0,d=c.pixels.length;u<d;u+=4)l(c.pixels,u);h(c)}}())}),t}function ee(...r){r=r.map(e=>Cs(e)).filter(e=>e),r=Rs(r);var t=r.length;return function(e,i,s={}){var a=e,n=0;function o(){r[n].call(null,a,function(c){a=c,l()},s)}function l(){if(n++,n>=t){i(a);return}o()}o()}}function Et(r){return ee(...r)}function tr(r,...t){var e=null;return t.length==1&&typeof t[0]=="string"?e=$t(t[0]):e=Et(t),(i,s,a={})=>{e(ze(i,r),function(n){s(Ke(i,n,r))},a)}}var Vs=$($({},Fe),Le),Hs={Color:C,HueColor:qt,ColorNames:xt,ImageFilter:Vs,Canvas:rt,ImageLoader:ot};C.color;let Os=0,It=[];class S{constructor(t,e,i){if(typeof t!="string")this.el=t;else{var s=document.createElement(t);this.uniqId=Os++,e&&(s.className=e),i=i||{};for(var a in i)s.setAttribute(a,i[a]);this.el=s}}static getScrollTop(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}static getScrollLeft(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}attr(t,e){return arguments.length==1?this.el.getAttribute(t):(this.el.setAttribute(t,e),this)}closest(t){for(var e=this,i=!1;!(i=e.hasClass(t));)if(e.el.parentNode)e=new S(e.el.parentNode);else return null;return i?e:null}checked(){return this.el.checked}removeClass(t){return this.el.className=` ${this.el.className} `.replace(` ${t} `," ").trim(),this}hasClass(t){if(this.el.className){var e=` ${this.el.className} `;return e.indexOf(` ${t} `)>-1}else return!1}addClass(t){return this.hasClass(t)||(this.el.className=`${this.el.className} ${t}`),this}toggleClass(t){this.hasClass(t)?this.removeClass(t):this.addClass(t)}html(t){try{typeof t=="string"?this.el.innerHTML=t:this.empty().append(t)}catch{console.log(t)}return this}find(t){return this.el.querySelector(t)}$(t){return new S(this.find(t))}findAll(t){return this.el.querySelectorAll(t)}$$(t){return[...this.findAll(t)].map(e=>new S(e))}empty(){return this.html("")}append(t){return typeof t=="string"?this.el.appendChild(document.createTextNode(t)):this.el.appendChild(t.el||t),this}appendTo(t){var e=t.el?t.el:t;return e.appendChild(this.el),this}remove(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this}text(){return this.el.textContent}css(t,e){if(arguments.length==2)this.el.style[t]=e;else if(arguments.length==1){if(typeof t=="string")return getComputedStyle(this.el)[t];var i=t||{};Object.keys(i).forEach(s=>{this.el.style[s]=i[s]})}return this}cssFloat(t){return parseFloat(this.css(t))}cssInt(t){return parseInt(this.css(t))}px(t,e){return this.css(t,e+"px")}offset(){var t=this.el.getBoundingClientRect();return{top:t.top+S.getScrollTop(),left:t.left+S.getScrollLeft()}}rect(){return this.el.getBoundingClientRect()}position(){return this.el.style.top?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.el.getBoundingClientRect()}size(){return[this.width(),this.height()]}width(){return this.el.offsetWidth||this.el.getBoundingClientRect().width}contentWidth(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}height(){return this.el.offsetHeight||this.el.getBoundingClientRect().height}contentHeight(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}dataKey(t){return this.uniqId+"."+t}data(t,e){if(arguments.length==2)It[this.dataKey(t)]=e;else{if(arguments.length==1)return It[this.dataKey(t)];var i=Object.keys(It),s=this.uniqId+".";return i.filter(function(a){return a.indexOf(s)==0}).map(function(a){return It[a]})}return this}val(t){return arguments.length==0?this.el.value:(arguments.length==1&&(this.el.value=t),this)}int(){return parseInt(this.val(),10)}float(){return parseFloat(this.val())}show(){return this.css("display","block")}hide(){return this.css("display","none")}toggle(){return this.css("display")=="none"?this.show():this.hide()}scrollTop(){return this.el===document.body?S.getScrollTop():this.el.scrollTop}scrollLeft(){return this.el===document.body?S.getScrollLeft():this.el.scrollLeft}on(t,e,i,s){return this.el.addEventListener(t,e,i,s),this}off(t,e){return this.el.removeEventListener(t,e),this}getElement(){return this.el}createChild(t,e="",i={},s={}){let a=new S(t,e,i);return a.css(s),this.append(a),a}firstChild(){return new S(this.el.firstElementChild)}replace(t,e){return this.el.replaceChild(e,t),this}}class er{constructor(t){this.$store=t,this.initialize()}initialize(){this.filterProps().forEach(t=>{this.$store.action(t,this)})}filterProps(t="/"){return Object.getOwnPropertyNames(this.__proto__).filter(e=>e.startsWith(t))}}class As extends er{initialize(){super.initialize(),this.$store.colorSetsList=[{name:"Material",colors:["#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#03A9F4","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548","#9E9E9E","#607D8B"],edit:!0},{name:"Custom",edit:!0,colors:[]},{name:"Color Scale",scale:["red","yellow","black"],count:5}],this.$store.currentColorSets={}}"/list"(t){return Array.isArray(t.userList)&&t.userList.length?t.userList:t.colorSetsList}"/setUserPalette"(t,e){t.userList=e,t.dispatch("/resetUserPalette"),t.dispatch("/setCurrentColorSets")}"/resetUserPalette"(t){t.userList&&t.userList.length&&(t.userList=t.userList.map((e,i)=>{if(typeof e.colors=="function"){const s=e.colors;e.colors=s(t),e._colors=s}return Object.assign({name:`color-${i}`,colors:[]},e)}),t.emit("changeUserList"))}"/setCurrentColorSets"(t,e){const i=t.dispatch("/list");typeof e=="undefined"?t.currentColorSets=i[0]:typeof e=="number"?t.currentColorSets=i[e]:t.currentColorSets=i.filter(function(s){return s.name==e})[0],t.emit("changeCurrentColorSets")}"/getCurrentColorSets"(t){return t.currentColorSets}"/addCurrentColor"(t,e){Array.isArray(t.currentColorSets.colors)&&(t.currentColorSets.colors.push(e),t.emit("changeCurrentColorSets"),t.emit("addCurrentColor",e))}"/setCurrentColorAll"(t,e=[]){t.currentColorSets.colors=e,t.emit("changeCurrentColorSets")}"/removeCurrentColor"(t,e){t.currentColorSets.colors[e]&&(t.currentColorSets.colors.splice(e,1),t.emit("changeCurrentColorSets"))}"/removeCurrentColorToTheRight"(t,e){t.currentColorSets.colors[e]&&(t.currentColorSets.colors.splice(e,Number.MAX_VALUE),t.emit("changeCurrentColorSets"))}"/clearPalette"(t){t.currentColorSets.colors&&(t.currentColorSets.colors=[],t.emit("changeCurrentColorSets"))}"/getCurrentColors"(t){return t.dispatch("/getColors",t.currentColorSets)}"/getColors"(t,e){return e.scale?C.scale(e.scale,e.count):e.colors||[]}"/getColorSetsList"(t){return t.dispatch("/list").map(e=>({name:e.name,edit:e.edit,colors:t.dispatch("/getColors",e)}))}}var K={addEvent(r,t,e,i){r&&r.addEventListener(t,e,i)},removeEvent(r,t,e){r&&r.removeEventListener(t,e)},pos(r){return r.touches&&r.touches[0]?r.touches[0]:r},posXY(r){var t=this.pos(r);return{x:t.pageX,y:t.pageY}}};const Ns=".";class Fs{constructor(t,e={}){this.masterObj=t,this.settingObj=e}set(t,e,i=void 0){this.settingObj[t]=e||i}init(t,...e){if(!this.has(t)||!this.settingObj[t]){const i=t.split(Ns),s=this.masterObj.refs[i[0]]||this.masterObj[i[0]]||this.masterObj,a=i.pop();if(s[a]){const n=s[a].apply(s,e);this.set(t,n)}}}get(t,e=""){return this.init(t,e),this.settingObj[t]||e}has(t){return!!this.settingObj[t]}}const Bs=/^(click|mouse(down|up|move|enter|leave)|touch(start|move|end)|key(down|up|press)|contextmenu|change|input)/ig,Ls=/^load (.*)/ig,rr=" ",Gs=["Control","Shift","Alt","Meta"];class Xs{constructor(){this.state=new Fs(this),this.refs={},this.childComponents=this.components()}newChildComponents(){Object.keys(this.childComponents).forEach(e=>{const i=this.childComponents[e];this[e]=new i(this)})}render(){this.$el=this.parseTemplate(this.template()),this.refs.$el=this.$el,this.parseTarget(),this.load(),this.afterRender()}afterRender(){}components(){return{}}parseTemplate(t){const e=new S("div").html(t).firstChild();var i=e.findAll("[ref]");return[...i].forEach(s=>{const a=s.getAttribute("ref");this.refs[a]=new S(s)}),e}parseTarget(){[...this.$el.findAll("[target]")].forEach(i=>{const s=i.getAttribute("target"),a=i.getAttribute("ref")||s;var n=this.childComponents[s],o=new n(this);if(this[a]=o,this.refs[a]=o.$el,o){o.render();var l=new S(i.parentNode);l.replace(i,o.$el.el)}})}load(){this.filterProps(Ls).forEach(t=>{const e=t.split("load ")[1];this.refs[e]&&this.refs[e].html(this.parseTemplate(this[t].call(this)))})}template(){return"<div></div>"}initialize(){}initializeEvent(){this.initializeEventMachin(),Object.keys(this.childComponents).forEach(t=>{this[t]&&this[t].initializeEvent()})}destroy(){this.destroyEventMachin(),Object.keys(this.childComponents).forEach(t=>{this[t]&&this[t].destroy()})}destroyEventMachin(){this.removeEventAll()}initializeEventMachin(){this.filterProps(Bs).forEach(this.parseEvent.bind(this))}collectProps(){if(!this.collapsedProps){var t=this.__proto__,e=[];do e.push(...Object.getOwnPropertyNames(t)),t=t.__proto__;while(t);this.collapsedProps=e}return this.collapsedProps}filterProps(t){return this.collectProps().filter(e=>e.match(t))}parseEvent(t){let e=t.split(rr);this.bindingEvent(e,this[t].bind(this))}getDefaultDomElement(t){let e;return t?e=this.refs[t]||this[t]||window[t]:e=this.el||this.$el||this.$root,e instanceof S?e.getElement():e}getDefaultEventObject(t){let e=t.split(".");const i=e.shift(),s=e.includes("Control"),a=e.includes("Shift"),n=e.includes("Alt"),o=e.includes("Meta");e=e.filter(c=>Gs.includes(c)===!1);const l=e.filter(c=>!!this[c]);return e=e.filter(c=>l.includes(c)===!1).map(c=>c.toLowerCase()),{eventName:i,isControl:s,isShift:a,isAlt:n,isMeta:o,codes:e,checkMethodList:l}}bindingEvent([t,e,...i],s){e=this.getDefaultDomElement(e);let a=this.getDefaultEventObject(t);a.dom=e,a.delegate=i.join(rr),this.addEvent(a,s)}matchPath(t,e){return t?t.matches(e)?t:this.matchPath(t.parentElement,e):null}getBindings(){return this._bindings||this.initBindings(),this._bindings}addBinding(t){this.getBindings().push(t)}initBindings(){this._bindings=[]}checkEventType(t,e){var i=e.isControl?t.ctrlKey:!0,s=e.isShift?t.shiftKey:!0,a=e.isAlt?t.altKey:!0,n=e.isMeta?t.metaKey:!0,o=!0;e.codes.length&&(o=e.codes.includes(t.code.toLowerCase())||e.codes.includes(t.key.toLowerCase()));var l=!0;return e.checkMethodList.length&&(l=e.checkMethodList.every(c=>this[c].call(this,t))),i&&a&&s&&n&&o&&l}makeCallback(t,e){return t.delegate?i=>{if(i.xy=K.posXY(i),this.checkEventType(i,t)){const s=this.matchPath(i.target||i.srcElement,t.delegate);if(s)return i.delegateTarget=s,i.$delegateTarget=new S(s),e(i)}}:i=>{if(i.xy=K.posXY(i),this.checkEventType(i,t))return e(i)}}addEvent(t,e){t.callback=this.makeCallback(t,e),this.addBinding(t);var i=!0;t.eventName==="touchstart"&&(i={passive:!0}),K.addEvent(t.dom,t.eventName,t.callback,i)}removeEventAll(){this.getBindings().forEach(t=>{this.removeEvent(t)}),this.initBindings()}removeEvent({eventName:t,dom:e,callback:i}){K.removeEvent(e,t,i)}}const _s=/^@/;class U extends Xs{constructor(t){super(t),this.opt=t||{},t&&t.$store&&(this.$store=t.$store),this.initialize(),this.initializeStoreEvent()}initializeStoreEvent(){this.storeEvents={},this.filterProps(_s).forEach(t=>{const e=t.split("@");e.shift();const i=e.join("@");this.storeEvents[i]=this[t].bind(this),this.$store.on(i,this.storeEvents[i])})}destoryStoreEvent(){Object.keys(this.storeEvents).forEach(t=>{this.$store.off(t,this.storeEvents[t])})}}function Ys(r){return typeof r=="undefined"||r==null}class zs extends er{initialize(){super.initialize(),this.$store.rgb={},this.$store.hsl={},this.$store.hsv={},this.$store.alpha=1,this.$store.format="hex"}"/changeFormat"(t,e){t.format=e,t.emit("changeFormat")}"/initColor"(t,e,i){t.dispatch("/changeColor",e,i,!0),t.emit("initColor")}"/changeColor"(t,e,i,s){e=e||"#FF0000",typeof e=="string"&&(e=C.parse(e)),e.source=e.source||i,t.alpha=Ys(e.a)?t.alpha:e.a,t.format=e.type!="hsv"&&e.type||t.format,e.type=="hsl"?(t.hsl=Object.assign(t.hsl,e),t.rgb=C.HSLtoRGB(t.hsl),t.hsv=C.HSLtoHSV(e)):e.type=="hex"||e.type=="rgb"?(t.rgb=Object.assign(t.rgb,e),t.hsl=C.RGBtoHSL(t.rgb),t.hsv=C.RGBtoHSV(e)):e.type=="hsv"&&(t.hsv=Object.assign(t.hsv,e),t.rgb=C.HSVtoRGB(t.hsv),t.hsl=C.HSVtoHSL(t.hsv)),s||t.emit("changeColor",e.source)}"/getHueColor"(t){return qt.checkHueColor(t.hsv.h/360)}"/toString"(t,e){e=e||t.format;var i=t[e]||t.rgb;return C.format(Q($({},i),{a:t.alpha}),e)}"/toColor"(t,e){return e=e||t.format,e=="rgb"?t.dispatch("/toRGB"):e=="hsl"?t.dispatch("/toHSL"):e=="hex"?t.dispatch("/toHEX"):t.dispatch("/toString",e)}"/toRGB"(t){return t.dispatch("/toString","rgb")}"/toHSL"(t){return t.dispatch("/toString","hsl")}"/toHEX"(t){return t.dispatch("/toString","hex").toUpperCase()}}class Ks{constructor(t){this.callbacks=[],this.actions=[],this.modules=t.modules||[],this.initialize()}initialize(){this.initializeModule()}initializeModule(){this.modules.forEach(t=>{new t(this)})}action(t,e){this.actions[t]={context:e,callback:e[t]}}dispatch(i){var e=[...arguments],i=e.shift(),s=this.actions[i];if(s)return s.callback.apply(s.context,[this,...e])}module(t){}on(t,e){this.callbacks.push({event:t,callback:e})}off(t,e){arguments.length==0?this.callbacks=[]:arguments.length==1?this.callbacks=this.callbacks.filter(i=>i.event!=t):arguments.length==2&&(this.callbacks=this.callbacks.filter(i=>i.event!=t&&i.callback!=e))}emit(){var t=[...arguments],e=t.shift();this.callbacks.filter(i=>i.event==e).forEach(i=>{i&&typeof i.callback=="function"&&i.callback(...t)})}}class Z extends U{constructor(t){super(t),this.isColorPickerShow=!1,this.isShortCut=!1,this.hideDelay=+(typeof this.opt.hideDeplay=="undefined"?2e3:this.opt.hideDelay),this.timerCloseColorPicker,this.autoHide=this.opt.autoHide||!0,this.outputFormat=this.opt.outputFormat,this.$checkColorPickerClass=this.checkColorPickerClass.bind(this)}initialize(){this.$body=null,this.$root=null,this.$store=new Ks({modules:[zs,As]}),this.callbackChange=()=>{this.callbackColorValue()},this.callbackLastUpdate=()=>{this.callbackLastUpdateColorValue()},this.callbackAddCurrentColor=t=>{this.callbackAddCurrentColorValue(t)},this.colorpickerShowCallback=function(){},this.colorpickerHideCallback=function(){},this.colorpickerLastUpdateCallback=function(){},this.colorpickerAddCurrentColorCallback=function(){},this.$body=new S(this.getContainer()),this.$root=new S("div","easylogic-colorpicker",{tabIndex:-1}),this.opt.position=="inline"&&this.$body.append(this.$root),this.opt.type&&this.$root.addClass(this.opt.type),this.opt.hideInformation&&this.$root.addClass("hide-information"),this.opt.hideColorsets&&this.$root.addClass("hide-colorsets"),this.$arrow=new S("div","arrow"),this.$root.append(this.$arrow),this.opt.colorSets?this.$store.dispatch("/setUserPalette",this.opt.colorSet):jt(this.opt.onRetrievePreset)?this.$store.dispatch("/setUserPalette",this.opt.onRetrievePreset()):this.$store.dispatch("/setUserPalette",[]),this.render(),this.$root.append(this.$el),this.initColorWithoutChangeEvent(this.opt.color),this.initializeEvent()}initColorWithoutChangeEvent(t){this.$store.dispatch("/initColor",t)}show(t,e,i,s,a,n){this.colorpickerShowCallback=i,this.colorpickerHideCallback=s,this.colorpickerLastUpdateCallback=a,this.colorpickerAddCurrentColorCallback=n,this.$root.css(this.getInitalizePosition()).show(),this.isColorPickerShow=!0,this.isShortCut=t.isShortCut||!1,this.outputFormat=t.outputFormat,this.hideDelay=+(typeof t.hideDelay=="undefined"?2e3:t.hideDelay),this.hideDelay>0&&this.setHideDelay(this.hideDelay),this.$root.appendTo(this.$body),this.definePosition(t),this.initColorWithoutChangeEvent(e)}initColor(t,e){this.$store.dispatch("/changeColor",t,e)}hide(){this.isColorPickerShow&&(this.$root.hide(),this.$root.remove(),this.isColorPickerShow=!1,this.callbackHideColorValue())}setColorsInPalette(t=[]){this.$store.dispatch("/setCurrentColorAll",t)}setUserPalette(t=[]){this.$store.dispatch("/setUserPalette",t)}getOption(t){return this.opt[t]}setOption(t,e){this.opt[t]=e}isType(t){return this.getOption("type")==t}isPaletteType(){return this.isType("palette")}isSketchType(){return this.isType("sketch")}getContainer(){return this.opt.container||document.body}getColor(t){return this.$store.dispatch("/toColor",t)}definePositionForArrow(t,e,i){}definePosition(t){var e=this.$root.width(),i=this.$root.height(),s=t.left-this.$body.scrollLeft();e+s>window.innerWidth&&(s-=e+s-window.innerWidth),s<0&&(s=0);var a=t.top-this.$body.scrollTop();i+a>window.innerHeight&&(a-=i+a-window.innerHeight),a<0&&(a=0),this.$root.css({left:s+"px",top:a+"px"})}getInitalizePosition(){return this.opt.position=="inline"?{position:"relative",left:"auto",top:"auto",display:"inline-block"}:{position:"fixed",left:"-10000px",top:"-10000px"}}isAbsolute(){return this.opt.position!=="inline"}"mouseup.isAbsolute document"(t){this.__isMouseDown=!1,this.checkInHtml(t.target)||(this.checkColorPickerClass(t.target)==!1?this.hide():this.__isMouseIn||(clearTimeout(this.timerCloseColorPicker),this.timerCloseColorPicker=setTimeout(this.hide.bind(this),this.delayTime||this.hideDelay)))}"keyup.isAbsolute.escape $root"(t){this.hide()}"mouseover.isAbsolute $root"(t){clearTimeout(this.timerCloseColorPicker)}"mousemove.isAbsolute $root"(t){clearTimeout(this.timerCloseColorPicker)}"mouseenter.isAbsolute $root"(t){clearTimeout(this.timerCloseColorPicker),this.__isMouseIn=!0}"mouseleave.isAbsolute $root"(t){this.__isMouseIn=!1,this.__isMouseDown||(clearTimeout(this.timerCloseColorPicker),this.timerCloseColorPicker=setTimeout(this.hide.bind(this),this.delayTime||this.hideDelay))}"mousedown.isAbsolute $root"(t){this.__isMouseDown=!0}setHideDelay(t){this.delayTime=t||0}runHideDelay(){this.isColorPickerShow&&this.setHideDelay()}callbackColorValue(t){t=t||this.getCurrentColor(),typeof this.opt.onChange=="function"&&this.opt.onChange.call(this,t),typeof this.colorpickerShowCallback=="function"&&this.colorpickerShowCallback(t)}callbackLastUpdateColorValue(t){t=t||this.getCurrentColor(),typeof this.opt.onLastUpdate=="function"&&this.opt.onLastUpdate.call(this,t),typeof this.colorpickerLastUpdateCallback=="function"&&this.colorpickerLastUpdateCallback(t)}callbackAddCurrentColorValue(t){typeof this.opt.onLastUpdate=="function"&&this.opt.onAddPreset.call(this,t),typeof this.colorpickerAddCurrentColorCallback=="function"&&this.colorpickerAddCurrentColorCallback(t)}callbackHideColorValue(t){t=t||this.getCurrentColor(),typeof this.opt.onHide=="function"&&this.opt.onHide.call(this,t),typeof this.colorpickerHideCallback=="function"&&this.colorpickerHideCallback(t)}getCurrentColor(){return this.$store.dispatch("/toColor",this.outputFormat)}checkColorPickerClass(t){var e=new S(t).closest("codemirror-colorview"),i=new S(t).closest("easylogic-colorpicker"),s=new S(t).closest("CodeMirror");return t.nodeName=="HTML",!!(i||e||s)}checkInHtml(t){var e=t.nodeName=="HTML";return e}initializeStoreEvent(){super.initializeStoreEvent(),this.$store.on("changeColor",this.callbackChange),this.$store.on("lastUpdateColor",this.callbackLastUpdate),this.$store.on("changeFormat",this.callbackChange),this.$store.on("addCurrentColor",this.callbackAddCurrentColor)}destroy(){super.destroy(),this.$store.off("changeColor",this.callbackChange),this.$store.off("lastUpdateColor",this.callbackLastUpdate),this.$store.off("changeFormat",this.callbackChange),this.$store.off("addCurrentColor",this.callbackAddCurrentColor),this.callbackChange=void 0,this.callbackLastUpdate=void 0,this.callbackAddCurrentColor=void 0,this.colorpickerShowCallback=void 0,this.colorpickerHideCallback=void 0}}class js extends U{constructor(t){super(t),this.source="base-box"}refresh(){}refreshColorUI(t){}changeColor(t){this.$store.dispatch("/changeColor",Object.assign({source:this.source},t||{}))}"mouseup document"(t){this.onDragEnd(t)}"mousemove document"(t){this.onDragMove(t)}"mousedown $bar"(t){t.preventDefault(),this.isDown=!0}"mousedown $container"(t){this.isDown=!0,this.onDragStart(t)}"touchend document"(t){this.onDragEnd(t)}"touchmove document"(t){this.onDragMove(t)}"touchstart $bar"(t){t.preventDefault(),this.isDown=!0}"touchstart $container"(t){this.onDragStart(t)}onDragStart(t){this.isDown=!0,this.refreshColorUI(t)}onDragMove(t){this.isDown&&this.refreshColorUI(t)}onDragEnd(t){this.isDown&&(this.$store.emit("lastUpdateColor"),this.isDown=!1)}"@changeColor"(t){this.source!=t&&this.refresh()}"@initColor"(){this.refresh()}}class mt extends js{constructor(t){super(t),this.minValue=0,this.maxValue=1,this.source="base-slider"}getMinMaxPosition(){var t=this.getMinPosition(),e=this.getMaxDist(),i=t+e;return{min:t,max:i,width:e}}getCurrent(t){return min+this.getMaxDist()*t}getMinPosition(){return this.refs.$container.offset().left}getMaxDist(){return this.state.get("$container.width")}getDist(t){var{min:e,max:i}=this.getMinMaxPosition(),s;return t<e?s=0:t>i?s=100:s=(t-e)/(i-e)*100,s}getCaculatedDist(t){var e=t?this.getMousePosition(t):this.getCurrent(this.getDefaultValue()/this.maxValue),i=this.getDist(e);return i}getDefaultValue(){return 0}setMousePosition(t){this.refs.$bar.css({left:t+"px"})}getMousePosition(t){return K.pos(t).pageX}refresh(){this.setColorUI()}setColorUI(t){if(t=t||this.getDefaultValue(),this.lastV===t)return!0;this.lastV=t,t<=this.minValue?this.refs.$bar.addClass("first").removeClass("last"):t>=this.maxValue?this.refs.$bar.addClass("last").removeClass("first"):this.refs.$bar.removeClass("last").removeClass("first"),this.setMousePosition(this.getMaxDist()*((t||0)/this.maxValue))}}class ir extends mt{constructor(t){super(t),this.minValue=0,this.maxValue=1,this.source="value-control"}template(){return`
            <div class="value">
                <div ref="$container" class="value-container">
                    <div ref="$bar" class="drag-bar"></div>
                </div>
            </div>
        `}setBackgroundColor(){this.refs.$container.css("background-color",this.$store.dispatch("/toRGB"))}refresh(){super.refresh(),this.setBackgroundColor()}getDefaultValue(){return this.$store.hsv.v}refreshColorUI(t){var e=this.getCaculatedDist(t);this.setColorUI(e/100*this.maxValue),this.changeColor({type:"hsv",v:e/100*this.maxValue})}}class Pt extends mt{constructor(t){super(t),this.minValue=0,this.maxValue=1,this.source="opacity-control"}template(){return`
        <div class="opacity">
            <div ref="$container" class="opacity-container">
                <div ref="$colorbar" class="color-bar"></div>
                <div ref="$bar" class="drag-bar2"></div>
            </div>
        </div>
        `}refresh(){super.refresh(),this.setOpacityColorBar()}setOpacityColorBar(){var t=Object.assign({},this.$store.rgb);t.a=0;var e=C.format(t,"rgb");t.a=1;var i=C.format(t,"rgb");this.setOpacityColorBarBackground(e,i)}setOpacityColorBarBackground(t,e){this.refs.$colorbar.css("background","linear-gradient(to right, "+t+", "+e+")")}getDefaultValue(){return this.$store.alpha}refreshColorUI(t){var e=this.getCaculatedDist(t);this.setColorUI(e/100*this.maxValue),this.changeColor({a:Math.floor(e)/100*this.maxValue})}}const Ws="macos-control";class qs extends U{components(){return{Value:ir,Opacity:Pt}}template(){return`
        <div class="control">
            <div target="Value" ></div>
            <div target="Opacity" ></div>
            <div ref="$controlPattern" class="empty"></div>
            <div ref="$controlColor" class="color"></div>
        </div>
        `}setBackgroundColor(){this.refs.$controlColor.css("background-color",this.$store.dispatch("/toRGB"))}refresh(){this.setColorUI(),this.setBackgroundColor()}setColorUI(){this.Value.setColorUI(),this.Opacity.setColorUI()}"@changeColor"(t){Ws!=t&&this.refresh()}"@initColor"(){this.refresh()}}class sr extends U{constructor(t){super(t),this.width=214,this.height=214,this.thinkness=0,this.half_thinkness=0,this.source="colorwheel"}template(){return`
        <div class="wheel">
            <canvas class="wheel-canvas" ref="$colorwheel" ></canvas>
            <div class="wheel-canvas" ref="$valuewheel" ></div>
            <div class="drag-pointer" ref="$drag_pointer"></div>
        </div>
        `}refresh(t){this.setColorUI(t)}setColorUI(t){this.renderCanvas(),this.renderValue(),this.setHueColor(null,t)}renderValue(){var t=1-this.$store.hsv.v;this.refs.$valuewheel.css({"background-color":`rgba(0, 0, 0, ${t})`})}renderWheel(t,e){this.width&&!t&&(t=this.width),this.height&&!e&&(e=this.height);const i=new S("canvas"),s=i.el.getContext("2d");i.el.width=t,i.el.height=e,i.css({width:t+"px",height:e+"px"});for(var a=s.getImageData(0,0,t,e),n=a.data,o=Math.floor(t/2),l=Math.floor(e/2),c=t>e?l:o,h=o,u=l,d=0;d<e;d++)for(var g=0;g<t;g++){var p=g-h+1,v=d-u+1,b=p*p+v*v,w=bt(p,v),k=C.HSVtoRGB(w,Math.min(Math.sqrt(b)/c,1),1),M=(d*t+g)*4;n[M]=k.r,n[M+1]=k.g,n[M+2]=k.b,n[M+3]=255}return s.putImageData(a,0,0),this.thinkness>0&&(s.globalCompositeOperation="destination-out",s.fillStyle="black",s.beginPath(),s.arc(h,u,c-this.thinkness,0,Math.PI*2),s.closePath(),s.fill()),i}renderCanvas(){if(this.$store.createdWheelCanvas)return;const t=this.refs.$colorwheel,e=t.el.getContext("2d");let[i,s]=t.size();this.width&&!i&&(i=this.width),this.height&&!s&&(s=this.height),t.el.width=i,t.el.height=s,t.css({width:i+"px",height:s+"px"});var a=this.renderWheel(i,s);e.drawImage(a.el,0,0),this.$store.createdWheelCanvas=!0}getDefaultValue(){return this.$store.hsv.h}getDefaultSaturation(){return this.$store.hsv.s}getCurrentXY(t,e,i,s,a){return t?K.posXY(t):Sr(e,i,s,a)}getRectangle(){var t=this.state.get("$el.width"),e=this.state.get("$el.height"),i=this.state.get("$colorwheel.width")/2,s=this.refs.$el.offset().left,a=s+t/2,n=this.refs.$el.offset().top,o=n+e/2;return{minX:s,minY:n,width:t,height:e,radius:i,centerX:a,centerY:o}}setHueColor(t,e){if(!!this.state.get("$el.width")){var{minX:i,minY:s,radius:a,centerX:n,centerY:o}=this.getRectangle(),{x:l,y:c}=this.getCurrentXY(t,this.getDefaultValue(),this.getDefaultSaturation()*a,n,o),h=l-n,u=c-o,d=h*h+u*u,g=bt(h,u);if(d>a*a)var{x:l,y:c}=this.getCurrentXY(null,g,a,n,o);var p=Math.min(Math.sqrt(d)/a,1);this.refs.$drag_pointer.css({left:l-i+"px",top:c-s+"px"}),e||this.changeColor({type:"hsv",h:g,s:p})}}changeColor(t){this.$store.dispatch("/changeColor",Object.assign({source:this.source},t||{}))}"@changeColor"(t){this.source!=t&&this.refresh(!0)}"@initColor"(){this.refresh(!0)}"mouseup document"(t){this.isDown&&(this.isDown=!1,this.$store.emit("lastUpdateColor"))}"mousemove document"(t){this.isDown&&this.setHueColor(t)}"mousedown $drag_pointer"(t){t.preventDefault(),this.isDown=!0}"mousedown $el"(t){this.isDown=!0,this.setHueColor(t)}"touchend document"(t){this.isDown&&(this.isDown=!1,this.$store.emit("lastUpdateColor"))}"touchmove document"(t){this.isDown&&this.setHueColor(t)}"touchstart $drag_pointer"(t){t.preventDefault(),this.isDown=!0}"touchstart $el"(t){t.preventDefault(),this.isDown=!0,this.setHueColor(t)}}const Tt="chromedevtool-information";class Dt extends U{template(){return`
        <div class="information hex">
            <div ref="$informationChange" class="information-change">
                <button ref="$formatChangeButton" type="button" class="format-change-button arrow-button"></button>
            </div>
            <div class="information-item hex">
                <div class="input-field hex">
                    <input ref="$hexCode" class="input" type="text" />
                    <div class="title">HEX</div>
                </div>
            </div>
            <div class="information-item rgb">
                <div class="input-field rgb-r">
                    <input ref="$rgb_r" class="input" type="number" step="1" min="0" max="255" />
                    <div class="title">R</div>
                </div>
                <div class="input-field rgb-g">
                    <input ref="$rgb_g" class="input" type="number" step="1" min="0" max="255" />
                    <div class="title">G</div>
                </div>
                <div class="input-field rgb-b">
                    <input ref="$rgb_b" class="input" type="number" step="1" min="0" max="255" />
                    <div class="title">B</div>
                </div>          
                <div class="input-field rgb-a">
                    <input ref="$rgb_a" class="input" type="number" step="0.01" min="0" max="1" />
                    <div class="title">A</div>
                </div>                                                            
            </div>
            <div class="information-item hsl">
                <div class="input-field hsl-h">
                    <input ref="$hsl_h" class="input" type="number" step="1" min="0" max="360" />
                    <div class="title">H</div>
                </div>
                <div class="input-field hsl-s">
                    <input ref="$hsl_s" class="input" type="number" step="1" min="0" max="100" />
                    <div class="postfix">%</div>
                    <div class="title">S</div>
                </div>
                <div class="input-field hsl-l">
                    <input ref="$hsl_l" class="input" type="number" step="1" min="0" max="100" />
                    <div class="postfix">%</div>                        
                    <div class="title">L</div>
                </div>
                <div class="input-field hsl-a">
                    <input ref="$hsl_a" class="input" type="number" step="0.01" min="0" max="1" />
                    <div class="title">A</div>
                </div>
            </div>
        </div>
        `}setCurrentFormat(t){this.format=t,this.initFormat()}initFormat(){var t=this.format||"hex";["hex","rgb","hsl"].filter(e=>e!==t).forEach(e=>{this.$el.removeClass(e)}),this.$el.addClass(t)}nextFormat(){var t=this.format||"hex",e="hex";t=="hex"?e="rgb":t=="rgb"?e="hsl":t=="hsl"&&(e="hex"),this.format=e,this.initFormat(),this.$store.dispatch("/changeFormat",this.format),this.$store.emit("lastUpdateColor")}goToFormat(t){this.format=t,(t==="rgb"||t==="hsl")&&this.initFormat(),this.$store.dispatch("/changeFormat",this.format)}getFormat(){return this.format||"hex"}checkNumberKey(t){var e=t.which,i=!1;return(e==37||e==39||e==8||e==46||e==9)&&(i=!0),!(!i&&(e<48||e>57))}checkNotNumberKey(t){return!this.checkNumberKey(t)}changeRgbColor(){this.$store.dispatch("/changeColor",{type:"rgb",r:this.refs.$rgb_r.int(),g:this.refs.$rgb_g.int(),b:this.refs.$rgb_b.int(),a:this.refs.$rgb_a.float(),source:Tt}),this.$store.emit("lastUpdateColor")}changeHslColor(){this.$store.dispatch("/changeColor",{type:"hsl",h:this.refs.$hsl_h.int(),s:this.refs.$hsl_s.int(),l:this.refs.$hsl_l.int(),a:this.refs.$hsl_a.float(),source:Tt}),this.$store.emit("lastUpdateColor")}"@changeColor"(t){Tt!=t&&this.refresh()}"@initColor"(){this.refresh()}"input $rgb_r"(t){this.changeRgbColor()}"input $rgb_g"(t){this.changeRgbColor()}"input $rgb_b"(t){this.changeRgbColor()}"input $rgb_a"(t){this.changeRgbColor()}"input $hsl_h"(t){this.changeHslColor()}"input $hsl_s"(t){this.changeHslColor()}"input $hsl_l"(t){this.changeHslColor()}"input $hsl_a"(t){this.changeHslColor()}"keyup $hexCode"(t){var e=this.refs.$hexCode.val();e.charAt(0)=="#"&&(e.length==7||e.length===9)&&(this.$store.dispatch("/changeColor",e,Tt),this.$store.emit("lastUpdateColor"))}"click $formatChangeButton"(t){this.nextFormat()}"click $el .information-item.hex .input-field .title"(t){this.goToFormat("hex")}"click $el .information-item.rgb .input-field .title"(t){this.goToFormat("hsl")}"click $el .information-item.hsl .input-field .title"(t){this.goToFormat("rgb")}setRGBInput(){this.refs.$rgb_r.val(this.$store.rgb.r),this.refs.$rgb_g.val(this.$store.rgb.g),this.refs.$rgb_b.val(this.$store.rgb.b),this.refs.$rgb_a.val(this.$store.alpha)}setHSLInput(){this.refs.$hsl_h.val(this.$store.hsl.h),this.refs.$hsl_s.val(this.$store.hsl.s),this.refs.$hsl_l.val(this.$store.hsl.l),this.refs.$hsl_a.val(this.$store.alpha)}setHexInput(){this.refs.$hexCode.val(this.$store.dispatch("/toHEX"))}refresh(){this.setCurrentFormat(this.$store.format),this.setRGBInput(),this.setHSLInput(),this.setHexInput()}}const Js="data-colorsets-index";class Ut extends U{template(){return`
            <div class="color-chooser">
                <div class="color-chooser-container">
                    <div class="colorsets-item colorsets-item-header">
                        <h1 class="title">Color Palettes</h1>
                        <span ref="$toggleButton" class="items">&times;</span>
                    </div>
                    <div ref="$colorsetsList" class="colorsets-list"></div>
                </div>
            </div>
        `}refresh(){this.load()}"@changeCurrentColorSets"(){this.refresh()}"@toggleColorChooser"(){this.toggle()}"load $colorsetsList"(){return`
            <div>
                ${this.$store.dispatch("/getColorSetsList").map((e,i)=>`
                        <div class="colorsets-item" data-colorsets-index="${i}" >
                            <h1 class="title">${e.name}</h1>
                            <div class="items">
                                <div>
                                    ${e.colors.filter((s,a)=>a<5).map(s=>(s=s||"rgba(255, 255, 255, 1)",`<div class="color-item" title="${s}">
                                                <div class="color-view" style="background-color: ${s}"></div>
                                            </div>`)).join("")}
                                </div>
                            </div>
                        </div>`).join("")}
            </div>
        `}show(){this.$el.addClass("open")}hide(){this.$el.removeClass("open")}toggle(){this.$el.toggleClass("open")}"click $toggleButton"(t){this.toggle()}"click $colorsetsList .colorsets-item"(t){const e=t.$delegateTarget;if(e){const i=parseInt(e.attr(Js));this.$store.dispatch("/setCurrentColorSets",i),this.hide()}}destroy(){super.destroy(),this.hide()}}class Rt extends U{template(){return`
            <div class="colorsets">
                <div class="menu" title="Open Color Palettes">
                    <button ref="$colorSetsChooseButton" type="button" class="color-sets-choose-btn arrow-button"></button>
                </div>
                <div ref="$colorSetsColorList" class="color-list"></div>
            </div>
        `}"load $colorSetsColorList"(){const t=this.$store.dispatch("/getCurrentColorSets"),e=this.$store.dispatch("/getCurrentColors");return`
            <div>
                <h6>${t.name}</h6>
                <div class="current-color-sets">
                ${e.map((i,s)=>`<div class="color-item" title="${i}" data-index="${s}" data-color="${i}">
                        <div class="empty"></div>
                        <div class="color-view" style="background-color: ${i}"></div>
                    </div>`).join("")}   
                ${t.edit?'<div class="add-color-item">+</div>':""}         
                </div>
            </div>
            
        `}refresh(){this.load()}addColor(t){this.$store.dispatch("/addCurrentColor",t)}"@changeCurrentColorSets"(){this.refresh()}"click $colorSetsChooseButton"(t){this.$store.emit("toggleColorChooser")}"contextmenu $colorSetsColorList"(t){if(t.preventDefault(),!this.$store.dispatch("/getCurrentColorSets").edit)return;const s=new S(t.target).closest("color-item");if(s){const a=parseInt(s.attr("data-index"));this.$store.emit("showContextMenu",t,a)}else this.$store.emit("showContextMenu",t)}"click $colorSetsColorList .add-color-item"(t){this.addColor(this.$store.dispatch("/toColor"))}"click $colorSetsColorList .color-item"(t){this.$store.dispatch("/changeColor",t.$delegateTarget.attr("data-color")),this.$store.emit("lastUpdateColor")}}class Vt extends U{template(){return`
            <ul class="colorsets-contextmenu">
                <li class="menu-item small-hide" data-type="remove-color">Remove color</li>
                <li class="menu-item small-hide" data-type="remove-all-to-the-right">Remove all to the right</li>
                <li class="menu-item" data-type="clear-palette">Clear palette</li>
            </ul>
        `}show(t,e){const i=K.pos(t);this.$el.css({top:i.clientY-10+"px",left:i.clientX+"px"}),this.$el.addClass("show"),this.selectedColorIndex=e,typeof this.selectedColorIndex=="undefined"?this.$el.addClass("small"):this.$el.removeClass("small")}hide(){this.$el.removeClass("show")}runCommand(t){switch(t){case"remove-color":this.$store.dispatch("/removeCurrentColor",this.selectedColorIndex);break;case"remove-all-to-the-right":this.$store.dispatch("/removeCurrentColorToTheRight",this.selectedColorIndex);break;case"clear-palette":this.$store.dispatch("/clearPalette");break}}"@showContextMenu"(t,e){this.show(t,e)}"click $el .menu-item"(t){t.preventDefault(),this.runCommand(t.$delegateTarget.attr("data-type")),this.hide()}}class ar extends Z{template(){return`
            <div class='colorpicker-body'>
                <div target="colorwheel"></div>
                <div target="control"></div>
                <div target="information"></div>
                <div target="currentColorSets"></div>
                <div target="colorSetsChooser"></div>
                <div target="contextMenu"></div>                
            </div>
        `}components(){return{colorwheel:sr,control:qs,information:Dt,currentColorSets:Rt,colorSetsChooser:Ut,contextMenu:Vt}}}class nr extends mt{constructor(t){super(t),this.minValue=0,this.maxValue=360,this.source="hue-control"}template(){return`
            <div class="hue"> 
                <div ref="$container" class="hue-container">
                    <div ref="$bar" class="drag-bar"></div>
                </div>
            </div>
        `}getDefaultValue(){return this.$store.hsv.h}refreshColorUI(t){var e=this.getCaculatedDist(t);this.setColorUI(e/100*this.maxValue)!==!0&&this.changeColor({h:e/100*this.maxValue,type:"hsv"})}}class Zs extends mt{initialize(){super.initialize(),this.minValue=0,this.maxValue=360,this.hueScaleDist=.05}template(){return`
            <div class="hue-scale">
                <div ref="$container" class="hue-scale-container">
                    <div ref="$bar" class="drag-bar"></div>
                </div>
            </div>
        `}getDefaultValue(){return this.$store.hsv.h}getCalculatedDist(t){var e=t?this.getMousePosition(t):this.getCurrent(this.getDefaultValue()/this.maxValue),i=this.getDist(e);return i}refreshColorUI(t){var e=this.getCalculatedDist(t);this.setColorUI(e/100)!==!0&&this.changeColor({h:(this.minValue+this.fullDist*(e/100))*360,type:"hsv"})}setColorUI(t){let e;if(t){if(e=this.minValue+t*this.fullDist,this.lastP===e)return!0;this.lastP=e}else{if(e=this.getDefaultValue()/360,this.lastP===e)return!0;this.lastP=e;let i=e+.05,s=e-.05;if(i>1)i=1,s=1-this.hueScaleDist*2;else if(s<0){const h=Math.abs(s);s=0,i=i+h}const a=qt.getHueScale(e,s,i);this.list=a;const n=a[0].start,o=a[a.length-1].start;this.minValue=n,this.maxValue=o;const l=this.maxValue-this.minValue;this.fullDist=l;const c=a.map(h=>({color:h.rgb,percent:(h.start-n)/l*100,unit:"%"}));this.refs.$container.css("background-image",`linear-gradient(to right, ${c.map(h=>`${h.color} ${h.percent}${h.unit}`).join(",")})`)}e<=this.minValue?(e=this.minValue,this.refs.$bar.addClass("first").removeClass("last")):e>=this.maxValue?(e=this.maxValue,this.refs.$bar.addClass("last").removeClass("first")):this.refs.$bar.removeClass("last").removeClass("first"),this.setMousePosition(this.getMaxDist()*((e-this.minValue)/this.fullDist))}}const or="chromedevtool-control";class Qs extends U{components(){return{Hue:nr,Opacity:Pt,HueScale:Zs}}template(){return`
        <div class="control">
            <div target="Hue" ></div>
            <div target="HueScale" ></div>
            <div target="Opacity" ></div>
            <div ref="$controlPattern" class="empty"></div>
            <div ref="$controlColor" class="color"></div>
            <div ref="$controlPattern2" class="empty2"></div>
            <div ref="$controlColor2" class="color2"></div>            
        </div>
        `}setBackgroundColor(){this.refs.$controlColor.css("background-color",this.$store.dispatch("/toRGB"))}setLastUpdateColor(){this.refs.$controlColor2.css("background-color",this.$store.dispatch("/toRGB"))}refresh(){this.setColorUI(),this.setBackgroundColor()}setColorUI(){this.Hue.setColorUI(),this.Opacity.setColorUI()}"@changeColor"(t){or!=t&&this.refresh()}"@lastUpdateColor"(t){or!=t&&this.setLastUpdateColor()}"@initColor"(){this.refresh()}}const lr="chromedevtool-palette";class lt extends U{template(){return`
        <div class="color">
            <div ref="$saturation" class="saturation">
                <div ref="$value" class="value">
                    <div ref="$drag_pointer" class="drag-pointer" data-axis-value="all">
                        <div ref="$left_saturation" class="left-saturation" data-axis-value="saturation"></div>
                        <div ref="$right_saturation" class="right-saturation" data-axis-value="saturation"></div>
                        <div ref="$top_value" class="top-value" data-axis-value="value"></div>
                        <div ref="$bottom_value" class="bottom-value" data-axis-value="value"></div>
                    </div>
                </div>
            </div>        
        </div>        
        `}setBackgroundColor(t){this.$el.css("background-color",t)}refresh(){this.cacheSize(),this.setColorUI()}calculateSV(){var t=this.drag_pointer_pos||{x:0,y:0},e=this.state.get("$el.width"),i=this.state.get("$el.height"),s=t.x/e,a=(i-t.y)/i;this.$store.dispatch("/changeColor",{type:"hsv",s,v:a,source:lr})}setColorUI(){var t=this.w*this.$store.hsv.s,e=this.h*(1-this.$store.hsv.v);this.refs.$drag_pointer.css({left:t+"px",top:e+"px"}),this.drag_pointer_pos={x:t,y:e},this.setBackgroundColor(this.$store.dispatch("/getHueColor"))}setSubColor(t){const e=t.pageX,i=t.pageY,s=e-this.x,a=i-this.y;var n=this.$el.contentWidth(),o=this.$el.contentHeight(),l=this.refs.$drag_pointer.cssFloat("left"),c=this.refs.$drag_pointer.cssFloat("top");this.axis==="saturation"?l+=s:this.axis==="value"&&(c+=a),l<0?l=0:l>n&&(l=n),c<0?c=0:c>o&&(c=o),this.refs.$drag_pointer.px("left",l),this.refs.$drag_pointer.px("top",c),this.drag_pointer_pos={x:l,y:c},this.x=e,this.y=i,this.calculateSV()}setMainColor(t){var e=this.$el.offset(),i=this.w,s=this.h,a=K.pos(t).pageX-e.left,n=K.pos(t).pageY-e.top;a<0?a=0:a>i&&(a=i),n<0?n=0:n>s&&(n=s),this.refs.$drag_pointer.css({left:a+"px",top:n+"px"}),this.drag_pointer_pos={x:a,y:n},this.calculateSV()}"@changeColor"(t){lr!=t&&this.refresh()}"@initColor"(){this.refresh()}"mouseup document"(t){this.isDown&&(this.isDown=!1,this.$store.emit("lastUpdateColor"))}"mousemove document"(t){this.isDown&&(this.cacheSize(),this.axis==="saturation"||this.axis==="value"?this.setSubColor(t):this.setMainColor(t))}mousedown(t){this.isDown=!0,this.cacheSize(),this.axis=new S(t.target).attr("data-axis-value"),this.x=t.pageX,this.y=t.pageY,this.axis==="saturation"||this.axis==="value"?this.setSubColor(t):this.setMainColor(t)}"touchend document"(t){this.isDown&&(this.isDown=!1,this.$store.emit("lastUpdateColor"))}"touchmove document"(t){this.isDown&&this.setMainColor(t)}touchstart(t){t.preventDefault(),this.isDown=!0,this.cacheSize(),this.setMainColor(t)}cacheSize(){this.w=this.state.get("$el.contentWidth"),this.h=this.state.get("$el.contentHeight")}}class re extends Z{template(){return`
            <div class='colorpicker-body'>
                <div target="palette"></div> 
                <div target="control"></div>
                <div target="information"></div>
                <div target="currentColorSets"></div>
                <div target="colorSetsChooser"></div>
                <div target="contextMenu"></div>
            </div>
        `}components(){return{palette:lt,control:Qs,information:Dt,currentColorSets:Rt,colorSetsChooser:Ut,contextMenu:Vt}}}const ta="mini-control";class ea extends U{components(){return{Hue:nr,Opacity:Pt}}template(){return`
        <div class="control">
            <div target="Hue" ></div>
            <div target="Opacity" ></div>
        </div>
        `}refresh(){this.setColorUI()}setColorUI(){this.Hue.setColorUI(),this.Opacity.setColorUI()}"@changeColor"(t){ta!=t&&this.refresh()}"@initColor"(){this.refresh()}}class cr extends Z{template(){return`
            <div class='colorpicker-body'>
                <div target="palette"></div>
                <div target="control"></div>
            </div>
        `}components(){return{palette:lt,control:ea}}}class hr extends mt{constructor(t){super(t),this.source="vertical-slider"}getMaxDist(){return this.state.get("$container.height")}setMousePosition(t){this.refs.$bar.css({top:t+"px"})}getMousePosition(t){return K.pos(t).pageY}getMinPosition(){return this.refs.$container.offset().top}getCaculatedDist(t){var e=t?this.getMousePosition(t):this.getCurrent(this.getDefaultValue()/this.maxValue),i=100-this.getDist(e);return i}setColorUI(t){t=t||this.getDefaultValue(),t<=this.minValue?this.refs.$bar.addClass("first").removeClass("last"):t>=this.maxValue?this.refs.$bar.addClass("last").removeClass("first"):this.refs.$bar.removeClass("last").removeClass("first");var e=1-(t||0)/this.maxValue;this.setMousePosition(this.getMaxDist()*e)}}class ie extends hr{constructor(t){super(t),this.minValue=0,this.maxValue=360,this.source="vertical-hue-control"}template(){return`
            <div class="hue">
                <div ref="$container" class="hue-container">
                    <div ref="$bar" class="drag-bar"></div>
                </div>
            </div>
        `}getDefaultValue(){return this.$store.hsv.h}refreshColorUI(t){var e=this.getCaculatedDist(t);this.setColorUI(e/100*this.maxValue),this.changeColor({h:e/100*this.maxValue,type:"hsv"})}}class se extends hr{constructor(t){super(t),this.source="vertical-opacity-control"}template(){return`
        <div class="opacity">
            <div ref="$container" class="opacity-container">
                <div ref="$colorbar" class="color-bar"></div>
                <div ref="$bar" class="drag-bar2"></div>
            </div>
        </div>
        `}refresh(){super.refresh(),this.setOpacityColorBar()}setOpacityColorBar(){var t=Object.assign({},this.$store.rgb);t.a=0;var e=C.format(t,"rgb");t.a=1;var i=C.format(t,"rgb");this.refs.$colorbar.css("background","linear-gradient(to top, "+e+", "+i+")")}getDefaultValue(){return this.$store.alpha}refreshColorUI(t){var e=this.getCaculatedDist(t);this.setColorUI(e/100*this.maxValue),this.changeColor({a:Math.floor(e)/100*this.maxValue})}}const ra="mini-control";class ia extends U{components(){return{Hue:ie,Opacity:se}}template(){return'<div class="control"><div target="Hue" ></div><div target="Opacity" ></div></div>'}refresh(){this.setColorUI()}setColorUI(){this.Hue.setColorUI(),this.Opacity.setColorUI()}"@changeColor"(t){ra!=t&&this.refresh()}"@initColor"(){this.refresh()}}class ur extends Z{template(){return`
            <div class='colorpicker-body'>
                <div target="palette"></div><div target="control"></div>
            </div>
        `}components(){return{palette:lt,control:ia}}}const sa="macos-control";class aa extends U{components(){return{Value:ir,Opacity:Pt}}template(){return`
        <div class="control">
            <div target="Value" ></div>
            <div target="Opacity" ></div>
            <div ref="$controlPattern" class="empty"></div>
            <div ref="$controlColor" class="color"></div>
        </div>
        `}setBackgroundColor(){this.refs.$controlColor.css("background-color",this.$store.dispatch("/toRGB"))}refresh(){this.setColorUI(),this.setBackgroundColor()}setColorUI(){this.Value.setColorUI(),this.Opacity.setColorUI()}"@changeColor"(t){sa!=t&&this.refresh()}"@initColor"(){this.refresh()}}class na extends sr{constructor(t){super(t),this.width=214,this.height=214,this.thinkness=16,this.half_thinkness=this.thinkness/2,this.source="colorring"}template(){return`
        <div class="wheel" data-type="ring">
            <canvas class="wheel-canvas" ref="$colorwheel" ></canvas>
            <div class="drag-pointer" ref="$drag_pointer"></div>
        </div>
        `}setColorUI(t){this.renderCanvas(),this.setHueColor(null,t)}getDefaultValue(){return this.$store.hsv.h}setHueColor(t,e){if(!!this.state.get("$el.width")){var{minX:i,minY:s,radius:a,centerX:n,centerY:o}=this.getRectangle(),{x:l,y:c}=this.getCurrentXY(t,this.getDefaultValue(),a,n,o),h=l-n,u=c-o,d=bt(h,u),{x:l,y:c}=this.getCurrentXY(null,d,a-this.half_thinkness,n,o);this.refs.$drag_pointer.css({left:l-i+"px",top:c-s+"px"}),e||this.changeColor({type:"hsv",h:d})}}}class fr extends Z{template(){return`
            <div class='colorpicker-body'>
                <div target="colorring"></div>
                <div target="palette"></div> 
                <div target="control"></div>
                <div target="information"></div>
                <div target="currentColorSets"></div>
                <div target="colorSetsChooser"></div>
                <div target="contextMenu"></div>
            </div>
        `}components(){return{colorring:na,palette:lt,control:aa,information:Dt,currentColorSets:Rt,colorSetsChooser:Ut,contextMenu:Vt}}}class oa extends U{components(){return{Hue:ie,Opacity:se}}template(){return`
        <div class="control">
            <div target="Hue" ></div>
            <div target="Opacity" ></div>
        </div>
        `}refresh(){this.setColorUI()}setColorUI(){this.Hue.setColorUI(),this.Opacity.setColorUI()}"@changeColor"(){this.refresh()}"@initColor"(){this.refresh()}}class la extends Z{template(){return`
            <div class='colorpicker-body'>
                <div target="palette"></div> 
                <div target="control"></div>
                <div target="information"></div>
                <div target="currentColorSets"></div>
                <div target="colorSetsChooser"></div>
                <div target="contextMenu"></div>
            </div>
        `}components(){return{palette:lt,control:oa,information:Dt,currentColorSets:Rt,colorSetsChooser:Ut,contextMenu:Vt}}}const ca="mini-control";class ha extends U{components(){return{Hue:ie,Opacity:se}}template(){return`
            <div class="control">
                <div target="Opacity" ></div>            
                <div target="Hue" ></div>
            </div>
        `}refresh(){this.setColorUI()}setColorUI(){this.Hue.setColorUI(),this.Opacity.setColorUI()}"@changeColor"(t){ca!=t&&this.refresh()}"@initColor"(){this.refresh()}}class dr extends Z{template(){return`
            <div class='colorpicker-body'>
                <div class='color-view'>
                    <div class='color-view-container'  ref="$colorview"></div>
                </div>
                <div class='color-tool'>
                    <div target="palette"></div>
                    <div target="control"></div>
                </div>
            </div>
        `}components(){return{palette:lt,control:ha}}initColorWithoutChangeEvent(t){this.$store.dispatch("/initColor",t),this.refresh()}setBackgroundColor(){var t=this.$store.dispatch("/toColor"),e=this.$store.rgb,i=C.brightness(e.r,e.g,e.b);this.refs.$colorview.css({"background-color":t,color:i>127?"black":"white"}),this.refs.$colorview.html(t)}"click $colorview"(t){this.nextFormat()}nextFormat(){var t=this.$store.format||"hex",e="hex";t=="hex"?e="rgb":t=="rgb"?e="hsl":t=="hsl"&&(e="hex"),this.$store.dispatch("/changeFormat",e),this.$store.emit("lastUpdateColor"),this.refresh()}refresh(){this.setBackgroundColor()}"@changeColor"(){this.refresh()}"@initColor"(){this.refresh()}}var gr={create(r){switch(r.type){case"macos":return new ar(r);case"xd":return new la(r);case"ring":return new fr(r);case"mini":return new cr(r);case"vscode":return new dr(r);case"mini-vertical":return new ur(r);case"sketch":case"palette":default:return new re(r)}},ColorPicker:re,ChromeDevToolColorPicker:re,MacOSColorPicker:ar,RingColorPicker:fr,MiniColorPicker:cr,VSCodePicker:dr,MiniVerticalColorPicker:ur};class ua extends U{afterRender(){var t=this.opt,e=t.opt.colorpickerOptions||{type:"sketch"};this.colorPicker=gr.create($({position:"inline",container:this.refs.$el.el,onChange:i=>{this.changeColor(i)},onLastUpdate:i=>{this.changeColor(i,!0)}},e))}template(){return'<div ref="$color"></div>'}changeColor(t,e=!1){this.$store.emit("changeEmbedColorPicker",t,e)}setValue(t){this.colorPicker.initColorWithoutChangeEvent(t)}}function pr(r){var t=[];return r.layers.length&&r.layers.forEach(e=>{t.push(...pr(e))}),t.push(r),t}class Ct{constructor(t={}){return t instanceof Ct&&(t=t.toJSON()),this.json=this.convert($($({},this.getDefaultObject()),t)),this.ref=new Proxy(this,{get:(e,i)=>{var s=e[i];return jt(s)?(...a)=>s.apply(e,a):s||e.json[i]},set:(e,i,s)=>{if(s&&s.realVal&&jt(s.realVal)&&(s=s.realVal()),this.checkField(i,s))e.json[i]=s;else throw new Error(`${s} is invalid as ${i} property value.`);return!0}}),this.ref}getDefaultTitle(){return"Item"}isAttribute(){return!1}get title(){return this.json.name||this.getDefaultTitle()}get id(){return this.json.id}get layers(){return this.json.layers}get parent(){return this.json.parent}is(...t){return this.json?t.indexOf(this.json.itemType)>-1:!1}convert(t){return t}checkField(t,e){return!0}toCloneObject(){var t={itemType:this.json.itemType,type:this.json.type,selected:this.json.selected};return t}clone(){var t=this.constructor,e=new t(this.toCloneObject());return e.parent=this.json.parent,e}reset(t){t instanceof Ct&&(t=t.toJSON()),this.json=this.convert($($({},this.json),t))}getDefaultObject(t={}){return $({selected:!1,type:"",itemType:""},t)}add(t){return this.json.layers.push(t),t.parent=this.ref,t}toggle(t,e){it(e)?this.json[t]=!this.json[t]:this.json[t]=!!e}toJSON(){return this.json}get html(){var{elementType:t,id:e,layers:i,itemType:s}=this.json;const a=t||"div";return`
    <${a} class='element-item ${s}' data-id="${e}">
      ${i.map(n=>n.html).join("")}
    </${a}>
    `}resize(){}copy(){this.json.parent.copyItem(this.ref)}copyItem(t){var e=t.clone();e.width.add(10),e.width.add(10);for(var i=this.json.layers,s=-1,a=0,n=i.length;a<n;a++)if(i[a]===t){s=a;break}s>-1&&this.json.layers.splice(s,0,e)}remove(){this.json.parent.removeItem(this.ref)}removeItem(t){for(var e=this.json.layers,i=-1,s=0,a=e.length;s<a;s++)if(e[s]===t){i=s;break}i>-1&&this.json.layers.splice(i,1)}get allLayers(){return[...pr(this.ref)]}}class fa extends Ct{getDefaultObject(t={}){return super.getDefaultObject($({itemType:"image-resource",type:"image"},t))}isGradient(){return!1}isLinear(){return!1}isRadial(){return!1}isConic(){return!1}isStatic(){return!1}isImage(){return!1}hasAngle(){return!1}isUrl(){return!1}isFile(){return!1}isAttribute(){return!0}toString(){return"none"}}const vr={center:50,top:0,left:0,right:100,bottom:100};class V{}V.CENTER="center",V.TOP="top",V.RIGHT="right",V.LEFT="left",V.BOTTOM="bottom";const da=/([\d.]+)(px|pt|fr|r?em|deg|vh|vw|m?s|%|g?rad|turn)/gi;class f{constructor(t="",e=""){this.value=t,this.unit=e}[Symbol.toPrimitive](t){return t=="number"?this.value:this.toString()}static min(...t){for(var e=t.shift(),i=0,s=t.length;i<s;i++)e.value>t[i].value&&(e=t[i]);return e}static max(...t){for(var e=t.shift(),i=0,s=t.length;i<s;i++)e.value<t[i].value&&(e=t[i]);return e}static string(t){return new f(t+"","")}static number(t){return new f(+t,"number")}static px(t){return new f(+t,"px")}static em(t){return new f(+t,"em")}static percent(t){return new f(+t,"%")}static deg(t){return new f(+t,"deg")}static fr(t){return new f(+t,"fr")}static second(t){return new f(+t,"s")}static ms(t){return new f(+t,"ms")}static var(t){return new f(t+"","--")}static calc(t){return new f(t,"calc")}static parse(t){if(Mt(t)){if(t.indexOf("calc(")>-1)return new f(t.split("calc(")[1].split(")")[0],"calc");var e=t.replace(da,"$1 $2").split(" ").filter(Boolean),i=+e[0]==e[0];return i?new f(+e[0],e[1]):new f(e[0])}if(t instanceof f)return t;if(t.unit){if(t.unit=="%"||t.unit=="percent"){var s=0;return T(t.percent)?s=t.percent:T(t.value)&&(s=t.value),f.percent(s)}else if(t.unit=="px"){var s=0;return T(t.px)?s=t.px:T(t.value)&&(s=t.value),f.px(s)}else if(t.unit=="em"){var s=0;return T(t.em)?s=t.em:T(t.value)&&(s=t.value),f.em(s)}else if(t.unit=="deg"){var s=0;return T(t.deg)?s=t.deg:T(t.value)&&(s=t.value),f.deg(s)}else if(t.unit=="s"){var s=0;return T(t.second)?s=t.second:T(t.value)&&(s=t.value),f.second(s)}else if(t.unit=="ms"){var s=0;return T(t.ms)?s=t.ms:T(t.value)&&(s=t.value),f.ms(s)}else if(t.unit=="number"){var s=0;return T(t.value)&&(s=t.value),f.number(s)}else if(t.unit=="--"){var s=0;return T(t.value)&&(s=t.value),f.var(s)}else if(t.unit===""||t.unit==="string"){var s="";return T(t.str)?s=t.str:T(t.value)&&(s=t.value),f.string(s)}}return f.string(t)}toString(){switch(this.unit){case"string":case"number":return this.value+"";case"var":return`var(--${this.value})`;case"calc":return`calc(${this.value})`;default:return this.value+this.unit}}isUnitType(t){return this.unit===t}isCalc(){return this.isUnitType("calc")}isFr(){return this.isUnitType("fr")}isPercent(){return this.isUnitType("%")}isPx(){return this.isUnitType("px")}isEm(){return this.isUnitType("em")}isDeg(){return this.isUnitType("deg")}isSecond(){return this.isUnitType("s")}isMs(){return this.isUnitType("ms")}isNumber(){return this.isUnitType("number")}isString(){return this.isUnitType("")}isVar(){return this.isUnitType("--")}set(t){return this.value=t,this}add(t){return this.value+=+t,this}sub(t){return this.add(-1*t)}mul(t){return this.value*=+t,this}div(t){return this.value/=+t,this}mod(t){return this.value%=+t,this}clone(){return new f(this.value,this.unit)}getUnitName(){return this.unit==="%"?"percent":this.unit}toJSON(){return{value:this.value,unit:this.unit}}rate(t){return t/this.value}stringToPercent(){return T(vr[this.value])?f.percent(vr[this.value]):f.percent(0)}stringToEm(t){return this.stringToPercent().toEm(t)}stringToPx(t){return this.stringToPercent().toPx(t)}toPercent(t,e=16){if(this.isPercent())return this;if(this.isPx())return f.percent(this.value*100/t);if(this.isEm())return f.percent(this.value*e*100/t);if(this.isString())return this.stringToPercent(t);if(this.isDeg())return f.percent(this.value/360*100)}toEm(t,e=16){if(this.isPercent())return f.em(this.value/100*t/e);if(this.isPx())return f.em(this.value/e);if(this.isEm())return this;if(this.isString())return this.stringToEm(t)}toPx(t,e=16){if(this.isPercent())return f.px(this.value/100*t);if(this.isPx())return this;if(this.isEm())return f.px(this.value/100*t/16);if(this.isString())return this.stringToPx(t)}toSecond(){if(this.isSecond())return this;if(this.isMs())return f.second(this.value/1e3)}toMs(){if(this.isSecond())return f.ms(this.value*1e3);if(this.isMs())return this}to(t,e,i=16){if(t==="px")return this.toPx(e,i);if(t==="%"||t==="percent")return this.toPercent(e,i);if(t==="em")return this.toEm(e,i)}toUnit(t){return new f(this.value,t)}calculate(t,e){var i=this[t];return i?i.call(this,e):this}includes(...t){return t.includes(this.value)}round(t){return new f(P(this.value,t),this.unit)}equals(t){return this.value===t.value&&this.unit===t.unit}}f.auto=f.string("auto");class F extends Ct{getDefaultObject(){return super.getDefaultObject({cut:!1,percent:0,unit:"%",px:0,em:0,color:"rgba(0, 0, 0, 0)",prevColorStep:null})}toCloneObject(){return Q($({},super.toCloneObject()),{cut:this.json.cut,percent:this.json.percent,unit:this.json.unit,px:this.json.px,em:this.json.em,color:this.json.color})}on(){this.json.cut=!0}off(){this.json.cut=!1}toggle(){this.json.cut=!this.json.cut}getUnit(){return this.json.unit=="%"?"percent":this.json.unit}add(t){var e=this.getUnit();return this.json[e]+=+t,this}sub(t){var e=this.getUnit();return this.json[e]-=+t,this}mul(t){var e=this.getUnit();return this.json[e]*=+t,this}div(t){var e=this.getUnit();return this.json[e]/=+t,this}mod(t){var e=this.getUnit();return this.json[e]%=+t,this}get isPx(){return this.json.unit=="px"}get isPercent(){return this.json.unit=="%"||this.json.unit==="percent"}get isEm(){return this.json.unit=="em"}toLength(t){return f.parse(this.json).round(1e3)}getPrevLength(){return this.json.prevColorStep?this.json.prevColorStep.toLength():""}toString(){var t=this.json.cut?this.getPrevLength():"";return`${this.json.color} ${t} ${this.toLength()}`}reset(t){super.reset(t),this.parent()&&this.parent().sortColorStep()}static parse(t){let e=[];const i=j(t);var s=i.str.split(" ").filter(o=>o.trim());const a=+s[0].replace("@",""),n=i.matches[a].color;if(s.length===1)e.push(new F({color:n,unit:"%",percent:0}));else if(s.length===2){const o=f.parse(s[1]);let l={unit:o.unit};o.isPercent()?l.percent=o.value:o.isPx()?l.px=o.value:o.isEm()&&(l.em=o.value),e.push(new F($({color:n},l)))}else s.length===3&&[1,2].forEach(o=>{const l=f.parse(s[o]);let c={unit:l.unit};l.isPercent()?c.percent=l.value:l.isPx()?c.px=l.value:l.isEm()&&(c.em=l.value),e.push(new F($({color:n},c)))});return e}}const mr={"to top":0,"to top right":45,"to right":90,"to bottom right":135,"to bottom":180,"to bottom left":225,"to left":270,"to top left":315};class Ht extends fa{isGradient(){return!0}toString(){return"none"}getDefaultObject(t={}){return super.getDefaultObject($({type:"gradient",colorsteps:[]},t))}toCloneObject(){return Q($({},super.toCloneObject()),{colorsteps:this.json.colorsteps.map(t=>t.clone())})}convert(t){return t.colorsteps=t.colorsteps.map(e=>new F(e)),t}calculateAngle(){var t=this.json.angle;return it(mr[t])?t:mr[t]||0}addColorStep(t,e=!0){return this.json.colorsteps.push(t),e&&this.sortColorStep(),t}insertColorStep(t,e="rgba(216,216,216,0)",i="rgba(216,216,216,1)"){var s=this.colorsteps;if(!s.length){this.addColorStepList([new F({color:e,percent:t,index:0}),new F({color:i,percent:100,index:100})]);return}if(t<s[0].percent){s[0].index=1,this.addColorStep(new F({index:0,color:s[0].color,percent:t}));return}var a=s.length-1;if(s[a].percent<t){var n=s[a].color,o=s[a].index+1;this.addColorStep(new F({index:o,color:n,percent:t}));return}for(var l=0,c=s.length-1;l<c;l++){var h=s[l],u=s[l+1];if(h.percent<=t&&t<=u.percent){var n=Color.mix(h.color,u.color,(t-h.percent)/(u.percent-h.percent),"rgb");this.addColorStep(new F({index:h.index+1,color:n,percent:t}));return}}}sortColorStep(){var t=this.colorsteps;t.sort((e,i)=>{if(e.percent>i.percent)return 1;if(e.percent<i.percent)return-1;if(e.percent==i.percent)return e.index===i.index?0:e.index>i.index?1:-1}),t.forEach((e,i)=>{e.index=i*100})}addColorStepList(t=[]){t.forEach(e=>{this.addColorStep(e,!1)}),this.sortColorStep()}getColorStep(t){return this.json.colorsteps.filter(e=>e.id==t)[0]}clear(...t){t.length?this.json.colorsteps.splice(+t[0],1):this.json.colorsteps=[]}get colorsteps(){return this.json.colorsteps}getColorString(){var t=this.colorsteps;if(!t.length)return"";var e=t.map((i,s)=>(i.prevColorStep=i.cut&&s>0?t[s-1]:null,i));return e.map(i=>`${i}`).join(",")}static random(){var t=Math.floor(Math.random()*1e3)%360;return`linear-gradient(${t}deg, ${Color.random()} 0%, ${Color.random()} 100%)`}}var ga=["circle","circle closest-side","circle closest-corner","circle farthest-side","circle farthest-corner","ellipse","ellipse closest-side","ellipse closest-corner","ellipse farthest-side","ellipse farthest-corner"];class pa extends U{initialize(){super.initialize();var t=[{offset:f.percent(0),cut:!1,color:"yellow"},{offset:f.percent(100),cut:!1,color:"red"}];this.type="linear-gradient",this.index=0,this.colorsteps=t,this.radialPosition=[f.percent(50),f.percent(50)],this.radialType="ellipse"}"@changeRadialPosition"(t,e){this["@changeKeyValue"]("radialPosition",[t,e]),this.reloadInputValue()}"@setGradientEditor"(t,e=0,i="linear-gradient",s,a,n){var o=j(t),l=o.str.split(",").map(c=>c.trim()).map(c=>{var[h,u,d]=c.split(" ").filter(v=>v.length);h=tt(h,o.matches);var g=!1;d&&(g=!0);var p=g?f.parse(d):f.parse(u);return p.isDeg()&&(p=f.percent(p.value/360*100)),{color:h,offset:p,cut:g}});l.length==1&&l.push({color:l[0].color,offset:f.percent(100),cut:!1}),this.cachedStepListRect=null,this.colorsteps=l,this.index=e,this.type=i,this.angle=f.parse(s||"90deg"),this.radialPosition=a||[f.percent(50),f.percent(50)],this.radialType=n,this.refresh(),this.selectStep(e),this.reloadInputValue()}template(){return`
        <div class='gradient-editor' data-selected-editor='${this.type}'>
            <div class='gradient-steps' data-editor='gradient'>
                <div class="hue-container" ref="$back"></div>            
                <div class="hue" ref="$steps">
                    <div class='step-list' ref="$stepList" ></div>
                </div>
            </div>
            <div class='tools' data-editor='tools'>
              <label>Offset <input type='checkbox' ref='$cut' checked />  connected</label> <div class="right-menu" ><button type="button" ref="$remove" style="float:right;" title="Remove color stop">&times; Remove</button></div>
              <div class='unit'>
                <div><input type='range' data-key='length' min='0' max="100" step='0.1' ref='$offset' /></div>
                <div><input type='number' data-key='length' min='0' max="100" step='0.1' ref='$offsetNumber' /></div>              
                <div><select ref='$offsetSelect'>
                  <option value='%'>%</option>
                  <option value='px'>px</option>
                  <option value='em'>em</option>
                </select></div>
              </div>
            </div>
            <div class='sub-editor' ref='$subEditor'> 
              <div data-editor='angle'>
                <label>Angle</label>
                <div class='unit'>                
                  <div><input type='range' data-key='angle' min='-720' max="720" step='0.1' ref='$angle' /> </div>
                  <div><input type='number' data-key='angle' min='-720' max="720" step='0.1' ref='$angleNumber' /></div> 
                  <span>deg</span>
                </div>
              </div>
              <div data-editor='centerX'>
                <label>Center X</label>
                <div class='unit'>
                  <div><input type='range' data-key='centerX' min='-100' max="100" step='0.1' ref='$centerX' /></div>
                  <div><input type='number' data-key='centerX' min='-100' max="100" step='0.1' ref='$centerXNumber' /></div>
                  <div><select ref='$centerXSelect'>
                      <option value='%'>%</option>
                      <option value='px'>px</option>
                      <option value='em'>em</option>
                    </select></div>
                </div>
              </div>                
              <div data-editor='centerY'>           
                <label>Center Y</label>                 
                <div class='unit'>
                  <div><input type='range' data-key='centerY' min='-100' max="100" step='0.1' ref='$centerY' /></div>
                  <div><input type='number' data-key='centerX' min='-100' max="100" step='0.1' ref='$centerYNumber' /></div>
                  <div><select ref='$centerYSelect'>
                      <option value='%'>%</option>
                      <option value='px'>px</option>
                      <option value='em'>em</option>
                    </select></div>
                </div>
              </div>                
              <div data-editor='radialType'>       
                <label>Radial Type</label>              
                <div><select ref='$radialType'>
                  ${ga.map(t=>{var e=this.radialType===t?"selected":"";return`<option value="${t}" ${e}>${t}</option>`}).join("")}
                </select></div>
              </div>
            </div>            
        </div>
      `}"input $offset"(t){this.refs.$offsetNumber.val(this.refs.$offset.val()),this["@changeColorStepOffset"]("offset",new f(this.refs.$offset.val(),this.refs.$offsetSelect.val()))}"mouseup $offset"(t){this["@changeColorStepOffset"]("offset",new f(this.refs.$offset.val(),this.refs.$offsetSelect.val()),!0)}"input $offsetNumber"(t){this.refs.$offset.val(this.refs.$offsetNumber.val()),this["@changeColorStepOffset"]("offset",new f(this.refs.$offset.val(),this.refs.$offsetSelect.val()),!0)}"input $angle"(t){this.refs.$angleNumber.val(this.refs.$angle.val()),this["@changeKeyValue"]("angle",f.deg(this.refs.$angle.val()))}"mouseup $angle"(t){this["@changeKeyValue"]("angle",f.deg(this.refs.$angle.val()),!0)}"input $angleNumber"(t){this.refs.$angle.val(this.refs.$angleNumber.val()),this["@changeKeyValue"]("angle",f.deg(this.refs.$angle.val()),!0)}"input $centerX"(t){this.refs.$centerXNumber.val(this.refs.$centerX.val()),this["@changeKeyValue"]("radialPositionX")}"mouseup $centerX"(t){this["@changeKeyValue"]("radialPositionX",null,!0)}"input $centerXNumber"(t){this.refs.$centerX.val(this.refs.$centerXNumber.val()),this["@changeKeyValue"]("radialPositionX")}"input $centerY"(t){this.refs.$centerYNumber.val(this.refs.$centerY.val()),this["@changeKeyValue"]("radialPositionY")}"mouseup $centerY"(t){this["@changeKeyValue"]("radialPositionY",null,!0)}"input $centerYNumber"(t){this.refs.$centerY.val(this.refs.$centerYNumber.val()),this["@changeKeyValue"]("radialPositionX")}"change $centerXSelect"(t){this["@changeKeyValue"]("radialPositionX",null,!0)}"change $centerYSelect"(t){this["@changeKeyValue"]("radialPositionY",null,!0)}get radialPositionX(){return new f(+this.refs.$centerX.val(),this.refs.$centerXSelect.val()).round(1e3)}get radialPositionY(){return new f(+this.refs.$centerY.val(),this.refs.$centerYSelect.val()).round(1e3)}"change $radialType"(t){this["@changeKeyValue"]("radialType",this.refs.$radialType.val(),!0)}"@changeKeyValue"(t,e,i=!1){t==="angle"&&(e=e.value),t==="radialPositionX"||t==="radialPositionY"?this.radialPosition=[this.radialPositionX,this.radialPositionY]:this[t]=e,this.updateData(i)}"@changeColorStepOffset"(t,e,i=!1){this.currentStep&&(this.currentStep.offset=e.clone(),this.$currentStep.css({left:this.currentStep.offset}),this.setColorUI(),this.updateData(i))}"click $back"(t){if(this.startXY)return;var e=this.refs.$stepList.rect(),i=e.x,s=e.right,a=t.xy.x;a<i?a=i:a>s&&(a=s);var n=(a-i)/e.width*100,o=this.colorsteps.map((u,d)=>({index:d,color:u.color,offset:u.offset})),l=o.filter(u=>u.offset.value<=n).pop(),c=o.filter(u=>u.offset.value>n).shift();let h=0;if(l&&c){if(l.offset.value===n)return;this.colorsteps.splice(c.index,0,{cut:!1,offset:f.percent(n),color:C.mix(l.color,c.color,(n-l.offset.value)/(c.offset.value-l.offset.value))}),h=l.index+1}else if(l){const u={cut:!1,offset:f.percent(n),color:l.color};this.colorsteps.length-1===l.index?this.colorsteps.push(u):this.colorsteps.splice(l.index+1,0,u),h=l.index+1}else if(c){const u={cut:!1,offset:f.percent(n),color:c.color};c.index===0?(this.colorsteps.unshift(u),h=0):(this.colorsteps.splice(c.index-1,0,u),h=c.index)}else this.colorsteps.push({cut:!1,offset:f.percent(0),color:"rgba(0, 0, 0, 1)"}),h=0;this.refresh(),this.updateData(!0),this.selectStep(h)}reloadStepList(){this.refs.$stepList.html(this.colorsteps.map((t,e)=>`<div class='step' data-index='${e}' data-cut='${t.cut}' style='left: ${t.offset};'>
        <div class='color-view' style="background-color: ${t.color}"></div>
        <div class='arrow' style="background-color: ${t.color}"></div>
      </div>`).join(""))}"click $cut"(){this.currentStep&&(this.currentStep.cut=this.refs.$cut.checked(),this.$currentStep.attr("data-cut",this.currentStep.cut),this.setColorUI(),this.updateData(!0))}"click $remove"(){this.removeStep(this.index)}removeStep(t){this.colorsteps.splice(t,1);var e=this.colorsteps[t],i=t;e||(e=this.colorsteps[t-1],i=t-1),e&&this.selectStep(i),this.refresh(),this.updateData(!0)}selectStep(t){this.index=t,this.currentStep=this.colorsteps[t],this.refs.$stepList.attr("data-selected-index",t),this.$currentStep=this.refs.$stepList.$(`[data-index="${t.toString()}"]`),this.$currentStep&&(this.$colorView=this.$currentStep.$(".color-view"),this.$arrow=this.$currentStep.$(".arrow"),this.refs.$cut.el.checked=this.currentStep.cut),this.prev=this.colorsteps[t-1],this.next=this.colorsteps[t+1]}"mousedown $stepList .step"(t){var e=+t.$delegateTarget.attr("data-index");t.altKey?this.removeStep(e):(this.selectStep(e),this.startXY=t.xy,this.$store.emit("selectColorStep",this.currentStep.color),this.refs.$cut.checked(this.currentStep.cut),this.refs.$offset.val(this.currentStep.offset.value),this.refs.$stepList.attr("data-selected-index",e),this.cachedStepListRect=this.refs.$stepList.rect())}getStepListRect(){return this.cachedStepListRect}"mouseup document"(t){this.startXY&&(this.startXY=null,this.updateData(!0))}"mousemove document"(t){if(!!this.startXY){var e=t.xy.x-this.startXY.x;t.xy.y-this.startXY.y;var i=this.getStepListRect(),s=i.x,a=i.right,n=this.startXY.x+e;n<s?n=s:n>a&&(n=a);var o=(n-s)/i.width*100;this.prev&&this.prev.offset.value>o&&(o=this.prev.offset.value),this.next&&this.next.offset.value<o&&(o=this.next.offset.value),this.currentStep.offset.set(P(o,100)),this.$currentStep.css({left:f.percent(o)}),this.refs.$offset.val(this.currentStep.offset.value),this.setColorUI(),this.updateData()}}refresh(){this.reloadStepList(),this.setColorUI()}getLinearGradient(){if(this.colorsteps.length===0)return"";if(this.colorsteps.length===1){var t=this.colorsteps[0];return`linear-gradient(to right, ${t.color} ${t.offset}, ${t.color} 100%)`}return`linear-gradient(to right, ${this.colorsteps.map((e,i)=>{if(e.cut){var s=this.colorsteps[i-1];return s?`${e.color} ${s.offset} ${e.offset}`:`${e.color} ${e.offset}`}else return`${e.color} ${e.offset}`}).join(",")})`}setColorUI(){this.refs.$stepList.css("background-image",this.getLinearGradient()),this.refs.$el.attr("data-selected-editor",this.type)}reloadInputValue(){this.refs.$offset.val(this.currentStep.offset.value),this.refs.$offsetNumber.val(this.currentStep.offset.value),this.refs.$offsetSelect.val(this.currentStep.offset.unit),this.refs.$angle.val(this.angle.value),this.refs.$angleNumber.val(this.angle.value);const t=this.radialPosition.map(e=>e==="center"?f.percent(50):e);this.refs.$centerX.val(t[0].value),this.refs.$centerXNumber.val(t[0].value),this.refs.$centerXSelect.val(t[0].unit),this.refs.$centerY.val(t[1].value),this.refs.$centerYNumber.val(t[1].value),this.refs.$centerYSelect.val(t[1].unit),this.refs.$radialType.val(this.radialType)}"@setColorStepColor"(t,e=!1){this.currentStep&&(this.currentStep.color=t,this.$colorView.css({"background-color":t}),this.$arrow.css({"background-color":t}),this.setColorUI(),this.updateData(e))}updateData(t=!1){this.$store.emit("changeGradientEditor",{type:this.type,index:this.index,angle:this.angle,colorsteps:this.colorsteps,radialPosition:this.radialPosition,radialType:this.radialType},t)}}const va={"0":"to top","45":"to top right","90":"to right","135":"to bottom right","180":"to bottom","225":"to bottom left","270":"to left","315":"to top left"},Cr={"to top":"0","to top right":"45","to right":"90","to bottom right":"135","to bottom":"180","to bottom left":"225","to left":"270","to top left":"315"};class nt extends Ht{getDefaultObject(t={}){return super.getDefaultObject($({type:"linear-gradient",angle:0},t))}toCloneObject(){return Q($({},super.toCloneObject()),{angle:this.json.angle})}isLinear(){return!0}hasAngle(){return!0}toString(){if(this.colorsteps.length===0)return"";var t=this.getColorString(),e="",i=this.json.angle||0;e=i,Se(e)&&(e=va[`${e}`]||e),Se(e)&&(e=e>360?e%360:e,e=`${e}deg`);var s=`${this.json.type}(${e}, ${t})`;return s}static toLinearGradient(t){if(t.length===0)return"none";var e=new nt({angle:"to right",colorsteps:t});return e+""}static parse(t){var e=j(t),i=0,s=[];return e.str.split("(")[1].split(")")[0].split(",").map(a=>a.trim()).forEach((a,n)=>{a.includes("@")?(a=tt(a,e.matches),s.push(...F.parse(a))):i=it(Cr[a])?f.parse(a):f.deg(+Cr[a])}),new nt({angle:i,colorsteps:s})}}class Ot extends nt{getDefaultObject(){return super.getDefaultObject({type:"repeating-linear-gradient",angle:0})}static parse(t){var e=nt.parse(t);return new Ot({angle:e.angle,colorsteps:e.colorsteps})}}const $a={center:!0,top:!0,left:!0,right:!0,bottom:!0};class ct extends Ht{getDefaultObject(t={}){return super.getDefaultObject($({type:"radial-gradient",radialType:"ellipse",radialPosition:[V.CENTER,V.CENTER]},t))}toCloneObject(){var t=this.json.radialPosition||[f.percent(50),f.percent(50)];return Q($({},super.toCloneObject()),{radialType:this.json.radialType||"ellipse",radialPosition:JSON.parse(JSON.stringify(t))})}isRadial(){return!0}toString(){if(this.colorsteps.length===0)return"";var t=this.getColorString(),e=this.json,i="",s=e.radialType,a=e.radialPosition||["center","center"];return $a[a]||typeof a=="string"||(a=a.map(n=>typeof n=="string"?n:n.isString()?n.value:n.round(1e3)).join(" ")),i=a?`${s} at ${a}`:s,`${e.type||"radial-gradient"}(${i}, ${t})`}static parse(t){var e=j(t),i="ellipse",s=[V.CENTER,V.CENTER],a=[];return e.str.split("(")[1].split(")")[0].split(",").map(n=>n.trim()).forEach((n,o)=>{if(n.includes("@"))n=tt(n,e.matches),a.push(...F.parse(n));else if(n.includes("at")?[i,s]=n.split("at").map(h=>h.trim()):i=n,Mt(s)){var l=s.split(" ");if(l.length===1){var c=f.parse(l[0]);c.isString()?s=[c.value,c.value]:s=[c.clone(),c.clone()]}else l.length===2&&(s=l.map(h=>{var u=f.parse(h);return u.isString()?u.value:u}))}}),new ct({radialType:i,colorsteps:a})}}class At extends ct{getDefaultObject(){return super.getDefaultObject({type:"repeating-radial-gradient"})}static parse(t){var e=ct.parse(t);return new At({radialType:e.radialType,radialPosition:e.radialPosition,colorsteps:e.colorsteps})}}const ma={center:!0,top:!0,left:!0,right:!0,bottom:!0},ae={"to top":0,"to top right":45,"to right":90,"to bottom right":135,"to bottom":180,"to bottom left":225,"to left":270,"to top left":315};class ht extends Ht{getDefaultObject(t={}){return super.getDefaultObject($({type:"conic-gradient",angle:0,radialPosition:[V.CENTER,V.CENTER]},t))}toCloneObject(){return Q($({},super.toCloneObject()),{angle:this.json.angle,radialPosition:JSON.parse(JSON.stringify(this.json.radialPosition))})}isConic(){return!0}hasAngle(){return!0}getColorString(){if(this.colorsteps.length===0)return"";var t=this.colorsteps;if(!t)return"";t.sort((i,s)=>i.percent==s.percent?0:i.percent>s.percent?1:-1);var e=t.map((i,s)=>(i.prevColorStep=i.cut&&s>0?t[s-1]:null,i));return e.map(i=>{var s=Math.floor(i.percent*3.6),a="";if(i.cut&&i.prevColorStep){var n=Math.floor(i.prevColorStep.percent*3.6);a=`${n}deg`}return`${i.color} ${a} ${s}deg`}).join(",")}toString(){var t=this.getColorString(),e=[],i=this.json,s=i.angle,a=i.radialPosition||V.CENTER;a=ma[a]?a:a.join(" "),T(s)&&(s=+(ae[s]||s),e.push(`from ${s}deg`)),a&&e.push(`at ${a}`);var n=e.length?e.join(" ")+",":"";return`${i.type}(${n} ${t})`}static parse(t){var e=j(t),i="0deg",s=[V.CENTER,V.CENTER],a=[];return e.str.split("(")[1].split(")")[0].split(",").map(n=>n.trim()).forEach((n,o)=>{if(n.includes("@"))n=n.split(" ").map(h=>h.trim()).map(h=>h.includes("deg")?f.parse(h).toPercent():h).join(" "),n=tt(n,e.matches),a.push(...F.parse(n));else{if(n.includes("at")?[i,s]=n.split("at").map(h=>h.trim()):i=n,Mt(s)){var l=s.split(" ");if(l.length===1){var c=f.parse(l[0]);c.isString()?s=[c.value,c.value]:s=[c.clone(),c.clone()]}else l.length===2&&(s=l.map(h=>{var u=f.parse(h);return u.isString()?u.value:u}))}Mt(i)&&i.includes("from")&&(i=i.split("from")[1],i=it(ae[i])?f.parse(i):f.deg(+ae[i]))}}),new ht({angle:i,radialPosition:s,colorsteps:a})}}class Nt extends ht{getDefaultObject(){return super.getDefaultObject({type:"repeating-conic-gradient",angle:0,radialPosition:[V.CENTER,V.CENTER]})}static parse(t){var e=ht.parse(t);return new Nt({angle:e.angle,radialPosition:e.radialPosition,colorsteps:e.colorsteps})}}const Ca=[{type:"linear-gradient",title:"Linear Gradient"},{type:"repeating-linear-gradient",title:"Repeating Linear Gradient"},{type:"radial-gradient",title:"Radial Gradient"},{type:"repeating-radial-gradient",title:"Repeating Radial Gradient"},{type:"conic-gradient",title:"Conic Gradient"},{type:"repeating-conic-gradient",title:"Repeating Conic Gradient"}],ba=/((linear\-gradient|repeating\-linear\-gradient|radial\-gradient|repeating\-radial\-gradient|conic\-gradient|repeating\-conic\-gradient|url)\(([^\)]*)\))/gi;class xa extends Z{components(){return{EmbedColorPicker:ua,gradientEditor:pa}}parseImage(t){var e=j(t);let i=null;return e.str.match(ba).forEach((s,a)=>{s=tt(s,e.matches),s.includes("repeating-linear-gradient")?i=Ot.parse(s):s.includes("linear-gradient")?i=nt.parse(s):s.includes("repeating-radial-gradient")?i=At.parse(s):s.includes("radial")?i=ct.parse(s):s.includes("repeating-conic-gradient")?i=Nt.parse(s):s.includes("conic")&&(i=ht.parse(s))}),i}callbackColorValue(t){var e=this.image.toString();typeof this.opt.onChange=="function"&&this.opt.onChange.call(this,e,this.image),typeof this.colorpickerShowCallback=="function"&&this.colorpickerShowCallback(e,this.image)}callbackLastUpdateColorValue(t){var e=this.image.toString();typeof this.opt.onLastUpdate=="function"&&this.opt.onLastUpdate.call(this,e,this.image)}callbackHideColorValue(t){var e=this.image.toString();typeof this.opt.onHide=="function"&&this.opt.onHide.call(this,e,this.image),typeof this.colorpickerHideCallback=="function"&&this.colorpickerHideCallback(e,this.image)}initialize(){super.initialize(),this.$root.addClass("gradient-picker"),this.selectedTab="linear-gradient",this.setValue(this.opt.gradient||"linear-gradient(to right, red 0%, yellow 100%)")}setValue(t){this.gradient=t,this.image=this.parseImage(this.gradient),this.selectTabContent(this.image.type)}getValue(){return this.image.toString()}template(){return`
      <div class="gradient-body">

        <div class='box'>
          <div class='gradient-preview'>
            <div class='gradient-view' ref='$gradientView'></div>
          </div>
          <div class="picker-tab">
            <div class="picker-tab-list" ref="$tab" data-value="static-gradient" data-is-image-hidden="false">
              ${Ca.map(t=>`
                  <span 
                    class='picker-tab-item ${t.selected?"selected":""}' 
                    data-selected-value='${t.type}'
                    title='${t.title}'
                  > 
                  <div class='icon'></div>
                  </span>`).join("")}
            </div>
          </div>
          <div target='gradientEditor'></div>

        </div>
        <div class='box'>
          <div target="EmbedColorPicker"></div>
        </div>
      </div>
     
    `}getColorString(){if(!this.image)return"";var t=this.image.getColorString();return t}getCurrentStepColor(){var t=this.image.colorsteps[this.selectColorStepIndex||0]||{color:"rgba(0, 0, 0, 1)"};return t.color}"@changeGradientEditor"(t,e=!1){var i=t.colorsteps.map((s,a)=>new F({color:s.color,percent:s.offset.value,cut:s.cut,index:(a+1)*100}));t=Q($({},t),{type:this.selectedTab,colorsteps:i}),this.image.reset(t),this.updateGradientPreview(e)}"click $tab .picker-tab-item"(t){const e=t.$delegateTarget.attr("data-selected-value");this.selectTabContent(e)}selectTabContent(t){this.selectedTab=t,this.refs.$tab.attr("data-value",t),this.image=this.createGradient({type:t},this.image),this.$store.emit("setGradientEditor",this.getColorString(),this.selectColorStepIndex,this.image.type,this.image.angle,this.image.radialPosition,this.image.radialType);var e=this.getCurrentStepColor();this["@selectColorStep"](e),this.updateGradientPreview(!0)}createGradient(t,e){const i=t.colorsteps||e.colorsteps,s=t.angle||e.angle,a=t.radialType||e.radialType||"ellipse",n=t.radialPosition||e.radialPosition||[f.percent(50),f.percent(50)];let o=e.clone().toJSON();switch(delete o.itemType,delete o.type,t.type){case"linear-gradient":return new nt({colorsteps:i,angle:s});case"repeating-linear-gradient":return new Ot({colorsteps:i,angle:s});case"radial-gradient":return new ct({colorsteps:i,radialType:a,radialPosition:n});case"repeating-radial-gradient":return new At({colorsteps:i,radialType:a,radialPosition:n});case"conic-gradient":return new ht({colorsteps:i,angle:s,radialPosition:n});case"repeating-conic-gradient":return new Nt({colorsteps:i,angle:s,radialPosition:n})}return new Ht}"@changeEmbedColorPicker"(t,e=!1){this.$store.emit("setColorStepColor",t,e)}"@selectColorStep"(t){this.EmbedColorPicker.setValue(t)}"@changeColorStep"(t={}){this.image.reset($({},t)),this.updateGradientPreview()}updateGradientPreview(t=!1){this.image&&(this.refs.$gradientView.css("background-image",this.image.toString()),this.updateData(t))}"mousedown $gradientView"(t){this.mouseDown=!0,this.mouseDownX=t.clientX,this.mouseDownY=t.clientY,this.rect=this.refs.$gradientView.rect()}"mousemove document"(t){if(this.mouseDown){var e=this.rect.left,i=this.rect.right,s=this.rect.top,a=this.rect.bottom,n=Math.min(Math.max(e,t.clientX),i),o=Math.min(Math.max(s,t.clientY),a),l=f.percent((n-e)/(i-e)*100),c=f.percent((o-s)/(a-s)*100);this.$store.emit("changeRadialPosition",l,c)}}"mouseup document"(t){this.mouseDown&&(this.mouseDown=!1,this.updateData(!0))}updateData(t=!1){this.callbackChange(),t&&this.callbackLastUpdate()}}var ya={createGradientPicker(r){return new xa(r)}},wa=$($($({},Hs),gr),ya);return wa});
